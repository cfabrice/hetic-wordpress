"use strict";

function _classCallCheck(e, t) {
    if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
}
var _createClass = function () {
        function e(e, t) {
            for (var i = 0; i < t.length; i++) {
                var s = t[i];
                s.enumerable = s.enumerable || !1, s.configurable = !0, "value" in s && (s.writable = !0), Object.defineProperty(e, s.key, s)
            }
        }
        return function (t, i, s) {
            return i && e(t.prototype, i), s && e(t, s), t
        }
    }(),
    Player = function () {
        function e(t) {
            var i = this,
                s = arguments.length > 1 && void 0 !== arguments[1] && arguments[1];
            if (_classCallCheck(this, e), this.container = t, this.button_toggle = this.container.querySelector(".section-videos-wrapper-controls--toggle"), this.video = this.container.querySelector(".section-videos-wrapper-video"), this.time_seek_bar = this.container.querySelector(".section-videos-wrapper-controls-seek-bar"), this.time_seek_bar_fill = this.time_seek_bar.querySelector(".section-videos-wrapper-controls-seek-bar--fill"), this.time_drag = !1, this.time_current = this.container.querySelector(".section-videos-wrapper-controls--time-current"), this.time_duration = this.container.querySelector(".section-videos-wrapper-controls--time-duration"), this.button_volume = this.container.querySelector(".section-videos-wrapper-controls-volume--icon"), this.volume_seek_bar = this.container.querySelector(".section-videos-wrapper-controls-volume--bar"), this.volume_seek_bar_fill = this.container.querySelector(".section-videos-wrapper-controls-volume--bar-fill"), this.volume_drag = !1, this.effect_pause = this.container.querySelector(".section-videos-wrapper-effect-pause"), this.effect_play = this.container.querySelector(".section-videos-wrapper-effect-play"), this.button_fullscreen = this.container.querySelector(".section-videos-wrapper-controls--fullscreen"), this.button_toggle.addEventListener("click", function () {
                    i.toggleState()
                }), this.time_seek_bar.addEventListener("click", function (e) {
                    i.time_positions = i.time_seek_bar.getBoundingClientRect(), i.updateTime(e)
                }), this.time_seek_bar.addEventListener("mousedown", function () {
                    i.time_drag || (i.time_positions = i.time_seek_bar.getBoundingClientRect(), i.time_drag = !0)
                }), window.addEventListener("mouseup", function () {
                    i.time_drag && (i.time_drag = !1), i.volume_drag && (i.volume_drag = !1)
                }), window.addEventListener("mousemove", function (e) {
                    i.time_drag && i.updateTime(e), i.volume_drag && i.updateVolume(e)
                }), this.button_volume.addEventListener("click", function () {
                    i.toggleMute()
                }), this.volume_seek_bar.addEventListener("click", function (e) {
                    i.volume_positions = i.volume_seek_bar.getBoundingClientRect(), i.updateVolume(e)
                }), this.volume_seek_bar.addEventListener("mousedown", function () {
                    i.volume_drag || (i.volume_positions = i.volume_seek_bar.getBoundingClientRect(), i.volume_drag = !0)
                }), this.button_fullscreen.addEventListener("click", function () {
                    i.toggleFullscreen()
                }), this.video.addEventListener("dblclick", function () {
                    i.toggleFullscreen()
                }), this.video.addEventListener("click", function () {
                    i.toggleState(), i.video.paused ? (i.effect_play.classList.add("active"), i.effect_pause.classList.remove("active")) : (i.effect_pause.classList.add("active"), i.effect_play.classList.remove("active"))
                }), this.playlist = s, this.playlist) {
                this.container_playlist = document.querySelector(".section-videos-nav-wrapper-list"), this.playlist_items = document.querySelectorAll(".section-videos-nav-wrapper-list-item"), this.playlist_next = document.querySelector(".section-videos-nav-controls--next"), this.playlist_prev = document.querySelector(".section-videos-nav-controls--prev"), this.playlist_index = 0, this.playlist_selected = this.playlist_items[this.playlist_index], this.playlist_item_width = this.playlist_items[0].getBoundingClientRect().width + 20, this.video_index = 0, this.video_prev = this.container.querySelector(".section-videos-wrapper-controls--skip-prev"), this.video_next = this.container.querySelector(".section-videos-wrapper-controls--skip-next"), this.playlist_next.addEventListener("click", function () {
                    i.playlist_index < i.playlist_items.length - i.playlist_size && (i.playlist_index++, i.updatePlaylist())
                }), this.playlist_prev.addEventListener("click", function () {
                    i.playlist_index > 0 && (i.playlist_index--, i.updatePlaylist())
                });
                for (var l = 0; l < this.playlist_items.length; l++) ! function () {
                    var e = i;
                    i.playlist_items[l].addEventListener("click", function () {
                        this != e.playlist_selected && (e.video_index = Array.prototype.indexOf.call(e.playlist_items, this), e.selectVideo())
                    })
                }();
                this.video_prev.addEventListener("click", function () {
                    i.video_index > 0 ? (i.video_index--, i.selectVideo()) : (i.video_prev.classList.add("hide"), console.log("nop prev")), i.video_next.classList.remove("hide")
                }), this.video_next.addEventListener("click", function () {
                    i.video_index < i.playlist_items.length - 1 ? (i.video_index++, i.selectVideo()) : (i.video_next.classList.add("hide"), console.log("nop next")), i.video_prev.classList.remove("hide")
                }), this.video.addEventListener("ended", function () {
                    i.video_index < i.playlist_items.length - 1 && (i.video_index++, i.selectVideo())
                }), this.initPlaylist()
            }
            window.addEventListener("resize", function () {
                i.playlist_item_width = i.playlist_items[0].getBoundingClientRect().width + 20, i.playlist && (console.log("resize"), i.initPlaylist())
            }), this.init()
        }
        return _createClass(e, [{
            key: "init",
            value: function () {
                var e = this;
                this.container.classList.remove("playing"), this.effect_pause.classList.remove("active"), this.effect_play.classList.remove("active"), this.video.addEventListener("loadeddata", function () {
                    e.video.currentTime = .45, e.time_duration.textContent = e.formatTime(e.video.duration), e.time_current.textContent = e.formatTime(e.video.currentTime), e.time_seek_bar_fill.style.transform = "scaleX(0)"
                })
            }
        }, {
            key: "initPlaylist",
            value: function () {
                var e = window.innerWidth;
                this.playlist_size = e < 425 ? 1 : e < 650 ? 2 : e < 900 ? 3 : e < 1300 ? 5 : e < 2500 ? 6 : 9, this.playlist_index = 0, this.updatePlaylist()
            }
        }, {
            key: "toggleState",
            value: function () {
                this.video.paused ? (this.video.play(), this.container.classList.add("playing"), this.render()) : (this.video.pause(), this.container.classList.remove("playing")), this.effect_pause.classList.remove("active"), this.effect_play.classList.remove("active")
            }
        }, {
            key: "updateTime",
            value: function (e) {
                var t = (e.pageX - this.time_positions.left) / this.time_positions.width;
                t >= 0 && t < 1 && (this.time_seek_bar_fill.style.transform = "scaleX(" + t + ")", this.video.currentTime = t * this.video.duration, this.time_current.textContent = this.formatTime(this.video.currentTime))
            }
        }, {
            key: "updateVolume",
            value: function (e) {
                var t = (e.pageX - this.volume_positions.left) / this.volume_positions.width;
                t >= 0 && t < 1 && (this.video.volume = t, this.volume_seek_bar_fill.style.transform = "scaleX(" + t + ")", this.video.muted && this.toggleMute(), t >= .5 ? (this.button_volume.classList.add("volume-2"), this.button_volume.classList.remove("volume-1"), this.button_volume.classList.remove("volume-0")) : t < .5 && t >= .25 ? (this.button_volume.classList.remove("volume-2"), this.button_volume.classList.add("volume-1"), this.button_volume.classList.remove("volume-0")) : t < .25 ? (this.button_volume.classList.remove("volume-2"), this.button_volume.classList.remove("volume-1"), this.button_volume.classList.add("volume-0")) : t <= 0 && (this.button_volume.classList.remove("volume-2"), this.button_volume.classList.remove("volume-1"), this.button_volume.classList.remove("volume-0"), this.toggleMute()))
            }
        }, {
            key: "toggleMute",
            value: function () {
                this.video.muted ? (this.video.muted = !1, this.button_volume.classList.remove("mute"), this.volume_seek_bar_fill.style.transform = "scaleX(" + this.video.volume + ")") : (this.video.muted = !0, this.button_volume.classList.add("mute"), this.volume_seek_bar_fill.style.transform = "scaleX(0)")
            }
        }, {
            key: "toggleFullscreen",
            value: function () {
                null == document.fullscreenElement && null == document.mozFullscreenElement && null == document.webkitFullscreenElement && null == document.msFullscreenElement ? this.container.requestFullscreen ? this.container.requestFullscreen() : this.container.mozRequestFullScreen ? this.container.mozRequestFullScreen() : this.container.webkitRequestFullscreen ? this.container.webkitRequestFullscreen() : this.container.msRequestFullscreen && this.container.msRequestFullscreen() : document.exitFullscreen ? document.exitFullscreen() : document.mozExitFullScreen ? document.mozExitFullScreen() : document.webkitExitFullscreen ? document.webkitExitFullscreen() : document.msExitFullscreen && document.msExitFullscreen()
            }
        }, {
            key: "updatePlaylist",
            value: function () {
                this.container_playlist.style.transform = "translateX(-" + this.playlist_index * this.playlist_item_width + "px)", 0 == this.playlist_index ? this.playlist_prev.classList.add("hide") : this.playlist_prev.classList.remove("hide"), this.playlist_index >= this.playlist_items.length - this.playlist_size ? this.playlist_next.classList.add("hide") : this.playlist_next.classList.remove("hide")
            }
        }, {
            key: "selectVideo",
            value: function () {
                this.playlist_selected.classList.remove("active"), this.playlist_selected = this.playlist_items[this.video_index], this.playlist_selected.classList.add("active"), this.video.src = this.playlist_selected.dataset.target, this.init(), this.video_index > this.playlist_index + this.playlist_size - 1 ? (this.playlist_index++, this.updatePlaylist()) : this.video_index < this.playlist_index && (this.playlist_index--, this.updatePlaylist()), 0 == this.video_index ? this.video_prev.classList.add("hide") : this.video_prev.classList.remove("hide"), this.video_index >= this.playlist_items.length - 1 ? this.video_next.classList.add("hide") : this.video_next.classList.remove("hide")
            }
        }, {
            key: "render",
            value: function () {
                this.video.paused || window.requestAnimationFrame(this.render.bind(this));
                var e = this.video.currentTime / this.video.duration;
                this.time_seek_bar_fill.style.transform = "scaleX(" + e + ")", this.time_current.textContent = this.formatTime(this.video.currentTime), this.video.currentTime == this.video.duration && this.container.classList.remove("playing")
            }
        }, {
            key: "formatTime",
            value: function (e) {
                e = Math.round(e);
                var t = Math.floor(e / 3600),
                    i = Math.floor((e - 3600 * t) / 60),
                    s = e - 3600 * t - 60 * i;
                return t = t < 10 ? "0" + t : t, i = i < 10 ? "0" + i : i, s = s < 10 ? "0" + s : s, 0 != t ? t + ":" + i + ":" + s : i + ":" + s
            }
        }]), e
    }(),
    burger_button = document.querySelector(".header-burger"),
    burger_nav = document.querySelector(".header-nav");
burger_button.addEventListener("click", function () {
    burger_button.classList.toggle("header-burger-active"), burger_nav.classList.toggle("header-nav-expand")
});
var header = document.querySelector(".header"),
    header_hide = !1;
document.body.addEventListener("mousewheel", function (e) {
    !header_hide && e.deltaY < 0 && !scroll_disabled ? (header.classList.remove("hide"), header_hide = !0) : header_hide && e.deltaY > 0 && document.body.scrollTop > 80 && !scroll_disabled && (header.classList.add("hide"), header_hide = !1)
});
for (var disabled_elements = document.querySelectorAll(".scroll-disable"), scroll_disabled = !1, i = 0; i < disabled_elements.length; i++) disabled_elements[i].addEventListener("mouseenter", function () {
    scroll_disabled = !0
}), disabled_elements[i].addEventListener("mouseleave", function () {
    scroll_disabled = !1
});
if (void 0 != document.querySelector(".section-exhibitions")) {
    var i;
    ! function () {
        var e = document.querySelectorAll(".section-exhibitions-container-slider-nav-list--item"),
            t = document.querySelector(".section-exhibitions-container-slider-nav-list"),
            s = document.querySelector(".section-exhibitions-container-slider-wrapper-list"),
            l = document.querySelector(".section-exhibitions-container-content-wrapper-list"),
            n = 0;
        for (i = 0; i < e.length; i++) e[i].addEventListener("click", function () {
            var i = Array.prototype.indexOf.call(e, this);
            void 0 != e[n] && e[n].classList.remove("active"), n = i, e[i].classList.add("active"), window.innerWidth >= 900 ? (s.style.transform = "translateX(-" + 100 * i + "%)", l.style.transform = "translateX(-" + 100 * i + "%)") : (s.style.transform = "translateX(-" + 100 * i + "%)", l.style.transform = "translateX(-" + 100 * i + "%)", t.style.transform = "translateX(-" + (i - 1) / 3 * 100 + "%)")
        })
    }()
}
if (void 0 != document.querySelector(".section-videos-wrapper")) var player = new Player(document.querySelector(".section-videos-wrapper"), !0);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBsYXllci5qcyIsIm1haW4uanMiXSwibmFtZXMiOlsiUGxheWVyIiwiY29udGFpbmVyIiwiX3RoaXMiLCJ0aGlzIiwicGxheWxpc3QiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfY2xhc3NDYWxsQ2hlY2siLCJidXR0b25fdG9nZ2xlIiwicXVlcnlTZWxlY3RvciIsInZpZGVvIiwidGltZV9zZWVrX2JhciIsInRpbWVfc2Vla19iYXJfZmlsbCIsInRpbWVfZHJhZyIsInRpbWVfY3VycmVudCIsInRpbWVfZHVyYXRpb24iLCJidXR0b25fdm9sdW1lIiwidm9sdW1lX3NlZWtfYmFyIiwidm9sdW1lX3NlZWtfYmFyX2ZpbGwiLCJ2b2x1bWVfZHJhZyIsImVmZmVjdF9wYXVzZSIsImVmZmVjdF9wbGF5IiwiYnV0dG9uX2Z1bGxzY3JlZW4iLCJhZGRFdmVudExpc3RlbmVyIiwidG9nZ2xlU3RhdGUiLCJlIiwidGltZV9wb3NpdGlvbnMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ1cGRhdGVUaW1lIiwid2luZG93IiwidXBkYXRlVm9sdW1lIiwidG9nZ2xlTXV0ZSIsInZvbHVtZV9wb3NpdGlvbnMiLCJ0b2dnbGVGdWxsc2NyZWVuIiwicGF1c2VkIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiY29udGFpbmVyX3BsYXlsaXN0IiwiZG9jdW1lbnQiLCJwbGF5bGlzdF9pdGVtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwbGF5bGlzdF9uZXh0IiwicGxheWxpc3RfcHJldiIsInBsYXlsaXN0X2luZGV4IiwicGxheWxpc3Rfc2VsZWN0ZWQiLCJwbGF5bGlzdF9pdGVtX3dpZHRoIiwid2lkdGgiLCJ2aWRlb19pbmRleCIsInZpZGVvX3ByZXYiLCJ2aWRlb19uZXh0IiwicGxheWxpc3Rfc2l6ZSIsInVwZGF0ZVBsYXlsaXN0IiwiaSIsInNlbGYiLCJBcnJheSIsInByb3RvdHlwZSIsImluZGV4T2YiLCJjYWxsIiwic2VsZWN0VmlkZW8iLCJfbG9vcCIsImNvbnNvbGUiLCJsb2ciLCJpbml0UGxheWxpc3QiLCJpbml0IiwiX3RoaXMyIiwiY3VycmVudFRpbWUiLCJ0ZXh0Q29udGVudCIsImZvcm1hdFRpbWUiLCJkdXJhdGlvbiIsInN0eWxlIiwidHJhbnNmb3JtIiwiaW5uZXJXaWR0aCIsInBsYXkiLCJyZW5kZXIiLCJwYXVzZSIsInJhdGlvIiwicGFnZVgiLCJsZWZ0Iiwidm9sdW1lIiwibXV0ZWQiLCJmdWxsc2NyZWVuRWxlbWVudCIsIm1vekZ1bGxzY3JlZW5FbGVtZW50Iiwid2Via2l0RnVsbHNjcmVlbkVsZW1lbnQiLCJtc0Z1bGxzY3JlZW5FbGVtZW50IiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJtb3pSZXF1ZXN0RnVsbFNjcmVlbiIsIndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuIiwibXNSZXF1ZXN0RnVsbHNjcmVlbiIsImV4aXRGdWxsc2NyZWVuIiwibW96RXhpdEZ1bGxTY3JlZW4iLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJzcmMiLCJkYXRhc2V0IiwidGFyZ2V0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYmluZCIsInRpbWUiLCJNYXRoIiwicm91bmQiLCJob3VycyIsImZsb29yIiwibWludXRlcyIsInNlY29uZHMiLCJidXJnZXJfYnV0dG9uIiwiYnVyZ2VyX25hdiIsInRvZ2dsZSIsImhlYWRlciIsImhlYWRlcl9oaWRlIiwiYm9keSIsImRlbHRhWSIsInNjcm9sbF9kaXNhYmxlZCIsInNjcm9sbFRvcCIsImRpc2FibGVkX2VsZW1lbnRzIiwiZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtIiwiZXhoaWJpdGlvbnNfYnV0dG9uc19jb250YWluZXIiLCJleGhpYml0aW9uc19saXN0X2ltZyIsImV4aGliaXRpb25zX2xpc3RfY29udGVudCIsImV4aGliaXRpb25zX2xhc3RfaW5kZXgiLCJpbmRleCIsInBsYXllciJdLCJtYXBwaW5ncyI6IjZYQUFNQSxPQUFBQSxXQUNKLFNBQUFBLEVBQVlDLEdB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RHlGLGlCQUFrQixJQU90QixRQUFxRDFHLEdBQWxEaUMsU0FBUzlCLGNBQWMsd0JBQXFDLENBQUEsSUFPcEQ0QyxHQVBvRCxXQUM3RCxJQUFNOEQsRUFBZ0M1RSxTQUFTRSxpQkFBaUIsd0RBQzFEMkUsRUFBZ0M3RSxTQUFTOUIsY0FBYyxrREFDdkQ0RyxFQUFnQzlFLFNBQVM5QixjQUFjLHNEQUN2RDZHLEVBQWdDL0UsU0FBUzlCLGNBQWMsdURBQ3pEOEcsRUFBa0MsRUFFdEMsSUFBU2xFLEVBQUksRUFBR0EsRUFBSThELEVBQXlCOUcsT0FBUWdELElBQ25EOEQsRUFBeUI5RCxHQUFHOUIsaUJBQWlCLFFBQVMsV0FDcEQsSUFBSWlHLEVBQVFqRSxNQUFNQyxVQUFVQyxRQUFRQyxLQUFLeUQsRUFBMEJqSCxXQUVaSSxHQUFwRDZHLEVBQXlCSSxJQUMxQkosRUFBeUJJLEdBQXdCcEYsVUFBVUUsT0FBTyxVQUVwRWtGLEVBQXlCQyxFQUV6QkwsRUFBeUJLLEdBQU9yRixVQUFVQyxJQUFJLFVBRTNDUCxPQUFPMkMsWUFBYyxLQUN0QjZDLEVBQXFCL0MsTUFBTUMsVUFBWSxlQUF5QixJQUFSaUQsRUFBYyxLQUN0RUYsRUFBeUJoRCxNQUFNQyxVQUFZLGVBQXlCLElBQVJpRCxFQUFjLE9BRzFFSCxFQUFxQi9DLE1BQU1DLFVBQVksZUFBeUIsSUFBUmlELEVBQWMsS0FDdEVGLEVBQXlCaEQsTUFBTUMsVUFBWSxlQUF5QixJQUFSaUQsRUFBYyxLQUMxRUosRUFBOEI5QyxNQUFNQyxVQUFZLGdCQUFtQmlELEVBQU0sR0FBRyxFQUFLLElBQU0sUUF6QmhDLEdBaUMvRCxRQUF3RGxILEdBQXJEaUMsU0FBUzlCLGNBQWMsMkJBQ3hCLElBQU1nSCxPQUFTLElBQUkxSCxPQUFPd0MsU0FBUzlCLGNBQWMsNEJBQTRCIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgUGxheWVye1xuICBjb25zdHJ1Y3Rvcihjb250YWluZXIsIHBsYXlsaXN0ID0gZmFsc2Upe1xuICAgIHRoaXMuY29udGFpbmVyICAgICA9IGNvbnRhaW5lclxuICAgIHRoaXMuYnV0dG9uX3RvZ2dsZSA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLS10b2dnbGUnKVxuICAgIHRoaXMudmlkZW8gICAgICAgICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLXZpZGVvJylcbiAgICBcbiAgICB0aGlzLnRpbWVfc2Vla19iYXIgICAgICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLXNlZWstYmFyJylcbiAgICB0aGlzLnRpbWVfc2Vla19iYXJfZmlsbCA9IHRoaXMudGltZV9zZWVrX2Jhci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy1zZWVrLWJhci0tZmlsbCcpXG4gICAgdGhpcy50aW1lX2RyYWcgICAgICAgICAgPSBmYWxzZVxuXG4gICAgdGhpcy50aW1lX2N1cnJlbnQgID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLXRpbWUtY3VycmVudCcpXG4gICAgdGhpcy50aW1lX2R1cmF0aW9uID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLXRpbWUtZHVyYXRpb24nKVxuICAgIFxuICAgIHRoaXMuYnV0dG9uX3ZvbHVtZSA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLXZvbHVtZS0taWNvbicpXG4gICAgdGhpcy52b2x1bWVfc2Vla19iYXIgICAgICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLXZvbHVtZS0tYmFyJylcbiAgICB0aGlzLnZvbHVtZV9zZWVrX2Jhcl9maWxsID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtdm9sdW1lLS1iYXItZmlsbCcpXG4gICAgdGhpcy52b2x1bWVfZHJhZyA9IGZhbHNlXG5cbiAgICB0aGlzLmVmZmVjdF9wYXVzZSA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWVmZmVjdC1wYXVzZScpXG4gICAgdGhpcy5lZmZlY3RfcGxheSAgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1lZmZlY3QtcGxheScpXG4gICAgXG4gICAgdGhpcy5idXR0b25fZnVsbHNjcmVlbiA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLS1mdWxsc2NyZWVuJylcblxuICAgIHRoaXMuYnV0dG9uX3RvZ2dsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgICB0aGlzLnRvZ2dsZVN0YXRlKClcbiAgICB9KVxuXG4gICAgdGhpcy50aW1lX3NlZWtfYmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpPT57XG4gICAgICB0aGlzLnRpbWVfcG9zaXRpb25zID0gdGhpcy50aW1lX3NlZWtfYmFyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICBcbiAgICAgIHRoaXMudXBkYXRlVGltZShlKVxuICAgIH0pXG5cbiAgICB0aGlzLnRpbWVfc2Vla19iYXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCk9PntcbiAgICAgIGlmKCF0aGlzLnRpbWVfZHJhZyl7XG4gICAgICAgIHRoaXMudGltZV9wb3NpdGlvbnMgPSB0aGlzLnRpbWVfc2Vla19iYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgICAgICBcbiAgICAgICAgdGhpcy50aW1lX2RyYWcgPSB0cnVlXG4gICAgICB9XG4gICAgfSlcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCk9PntcbiAgICAgIGlmKHRoaXMudGltZV9kcmFnKXtcbiAgICAgICAgdGhpcy50aW1lX2RyYWcgPSBmYWxzZVxuICAgICAgfVxuXG4gICAgICBpZih0aGlzLnZvbHVtZV9kcmFnKXtcbiAgICAgICAgdGhpcy52b2x1bWVfZHJhZyA9IGZhbHNlXG4gICAgICB9XG4gICAgfSlcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCAoZSk9PntcbiAgICAgIGlmKHRoaXMudGltZV9kcmFnKXtcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lKGUpXG4gICAgICB9XG4gICAgICBpZih0aGlzLnZvbHVtZV9kcmFnKXtcbiAgICAgICAgdGhpcy51cGRhdGVWb2x1bWUoZSkgICAgICAgIFxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLmJ1dHRvbl92b2x1bWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PntcbiAgICAgIHRoaXMudG9nZ2xlTXV0ZSgpXG4gICAgfSlcblxuICAgIHRoaXMudm9sdW1lX3NlZWtfYmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+e1xuICAgICAgdGhpcy52b2x1bWVfcG9zaXRpb25zID0gdGhpcy52b2x1bWVfc2Vla19iYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIHRoaXMudXBkYXRlVm9sdW1lKGUpXG4gICAgfSlcblxuICAgIHRoaXMudm9sdW1lX3NlZWtfYmFyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsICgpPT57XG4gICAgICBpZighdGhpcy52b2x1bWVfZHJhZyl7XG4gICAgICAgIHRoaXMudm9sdW1lX3Bvc2l0aW9ucyA9IHRoaXMudm9sdW1lX3NlZWtfYmFyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpICAgICAgXG4gICAgICAgIHRoaXMudm9sdW1lX2RyYWcgPSB0cnVlXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMuYnV0dG9uX2Z1bGxzY3JlZW4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xuICAgICAgdGhpcy50b2dnbGVGdWxsc2NyZWVuKClcbiAgICB9KVxuXG4gICAgdGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsICgpPT57XG4gICAgICB0aGlzLnRvZ2dsZUZ1bGxzY3JlZW4oKSAgICAgIFxuICAgIH0pXG5cbiAgICB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PntcbiAgICAgIHRoaXMudG9nZ2xlU3RhdGUoKVxuICAgICAgaWYodGhpcy52aWRlby5wYXVzZWQpe1xuICAgICAgICB0aGlzLmVmZmVjdF9wbGF5LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgICAgIHRoaXMuZWZmZWN0X3BhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgICB9XG4gICAgICBlbHNle1xuICAgICAgICB0aGlzLmVmZmVjdF9wYXVzZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgICAgICB0aGlzLmVmZmVjdF9wbGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMucGxheWxpc3QgPSBwbGF5bGlzdCAgICBcbiAgICBpZih0aGlzLnBsYXlsaXN0KXtcbiAgICAgIHRoaXMuY29udGFpbmVyX3BsYXlsaXN0ICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy1uYXYtd3JhcHBlci1saXN0JylcbiAgICAgIHRoaXMucGxheWxpc3RfaXRlbXMgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uLXZpZGVvcy1uYXYtd3JhcHBlci1saXN0LWl0ZW0nKVxuICAgICAgdGhpcy5wbGF5bGlzdF9uZXh0ICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLW5hdi1jb250cm9scy0tbmV4dCcpXG4gICAgICB0aGlzLnBsYXlsaXN0X3ByZXYgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3MtbmF2LWNvbnRyb2xzLS1wcmV2JylcbiAgICAgIHRoaXMucGxheWxpc3RfaW5kZXggICAgICA9IDBcbiAgICAgIHRoaXMucGxheWxpc3Rfc2VsZWN0ZWQgICA9IHRoaXMucGxheWxpc3RfaXRlbXNbdGhpcy5wbGF5bGlzdF9pbmRleF1cbiAgICAgIHRoaXMucGxheWxpc3RfaXRlbV93aWR0aCA9IHRoaXMucGxheWxpc3RfaXRlbXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggKyAyMFxuICAgICAgXG4gICAgICB0aGlzLnZpZGVvX2luZGV4ICAgPSAwXG4gICAgICB0aGlzLnZpZGVvX3ByZXYgICAgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy0tc2tpcC1wcmV2JylcbiAgICAgIHRoaXMudmlkZW9fbmV4dCAgICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLS1za2lwLW5leHQnKVxuXG4gICAgICB0aGlzLnBsYXlsaXN0X25leHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xuICAgICAgICBpZih0aGlzLnBsYXlsaXN0X2luZGV4IDwgdGhpcy5wbGF5bGlzdF9pdGVtcy5sZW5ndGggLSB0aGlzLnBsYXlsaXN0X3NpemUpe1xuICAgICAgICAgIHRoaXMucGxheWxpc3RfaW5kZXgrK1xuICAgICAgICAgIHRoaXMudXBkYXRlUGxheWxpc3QoKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICB0aGlzLnBsYXlsaXN0X3ByZXYuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xuICAgICAgICBpZih0aGlzLnBsYXlsaXN0X2luZGV4ID4gMCl7XG4gICAgICAgICAgdGhpcy5wbGF5bGlzdF9pbmRleC0tIFxuICAgICAgICAgIHRoaXMudXBkYXRlUGxheWxpc3QoKVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMucGxheWxpc3RfaXRlbXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXNcbiAgICAgICAgdGhpcy5wbGF5bGlzdF9pdGVtc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgaWYodGhpcyAhPSBzZWxmLnBsYXlsaXN0X3NlbGVjdGVkKXtcbiAgICAgICAgICAgIHNlbGYudmlkZW9faW5kZXggPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKHNlbGYucGxheWxpc3RfaXRlbXMsIHRoaXMpXG4gICAgICAgICAgICBzZWxmLnNlbGVjdFZpZGVvKClcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9XG5cbiAgICAgIHRoaXMudmlkZW9fcHJldi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgICAgIGlmKHRoaXMudmlkZW9faW5kZXggPiAwKXtcbiAgICAgICAgICB0aGlzLnZpZGVvX2luZGV4LS1cbiAgICAgICAgICB0aGlzLnNlbGVjdFZpZGVvKClcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgIHRoaXMudmlkZW9fcHJldi5jbGFzc0xpc3QuYWRkKCdoaWRlJylcbiAgICAgICAgICBjb25zb2xlLmxvZygnbm9wIHByZXYnKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMudmlkZW9fbmV4dC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJykgIFxuICAgICAgfSlcblxuICAgICAgdGhpcy52aWRlb19uZXh0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PntcbiAgICAgICAgaWYodGhpcy52aWRlb19pbmRleCA8IHRoaXMucGxheWxpc3RfaXRlbXMubGVuZ3RoIC0gMSl7XG4gICAgICAgICAgdGhpcy52aWRlb19pbmRleCsrXG4gICAgICAgICAgdGhpcy5zZWxlY3RWaWRlbygpXG4gICAgICAgIH1cbiAgICAgICAgZWxzZXtcbiAgICAgICAgICB0aGlzLnZpZGVvX25leHQuY2xhc3NMaXN0LmFkZCgnaGlkZScpXG4gICAgICAgICAgY29uc29sZS5sb2coJ25vcCBuZXh0JylcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZpZGVvX3ByZXYuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpXG4gICAgICB9KVxuXG4gICAgICB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2VuZGVkJywgKCk9PntcbiAgICAgICAgaWYodGhpcy52aWRlb19pbmRleCA8IHRoaXMucGxheWxpc3RfaXRlbXMubGVuZ3RoIC0gMSl7XG4gICAgICAgICAgdGhpcy52aWRlb19pbmRleCsrXG4gICAgICAgICAgdGhpcy5zZWxlY3RWaWRlbygpXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHRoaXMuaW5pdFBsYXlsaXN0KClcbiAgICB9XG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgKCk9PntcbiAgICAgIHRoaXMucGxheWxpc3RfaXRlbV93aWR0aCA9IHRoaXMucGxheWxpc3RfaXRlbXNbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGggKyAyMCAgICAgIFxuICAgICAgaWYodGhpcy5wbGF5bGlzdCl7XG4gICAgICAgIGNvbnNvbGUubG9nKCdyZXNpemUnKVxuICAgICAgICB0aGlzLmluaXRQbGF5bGlzdCgpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMuaW5pdCgpXG4gICAgICBcbiAgfVxuXG4gIC8vIGluaXQgbmV3IHZpZGVvXG4gIGluaXQoKXtcbiAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5aW5nJylcbiAgICB0aGlzLmVmZmVjdF9wYXVzZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgIHRoaXMuZWZmZWN0X3BsYXkuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZGRhdGEnLCAoKSA9PntcbiAgICAgIHRoaXMudmlkZW8uY3VycmVudFRpbWUgPSAuNDVcbiAgICAgIHRoaXMudGltZV9kdXJhdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmR1cmF0aW9uKSAgIFxuICAgICAgdGhpcy50aW1lX2N1cnJlbnQudGV4dENvbnRlbnQgPSB0aGlzLmZvcm1hdFRpbWUodGhpcy52aWRlby5jdXJyZW50VGltZSkgICAgICAgXG4gICAgICBcbiAgICAgIHRoaXMudGltZV9zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoMCknICAgIFxuICAgIH0pICAgIFxuICB9XG5cbiAgaW5pdFBsYXlsaXN0KCl7XG4gICAgbGV0IHdpZHRoID0gd2luZG93LmlubmVyV2lkdGhcbiAgICBpZih3aWR0aCA8IDQyNSl7XG4gICAgICB0aGlzLnBsYXlsaXN0X3NpemUgPSAxXG4gICAgfVxuICAgIGVsc2UgaWYod2lkdGggPCA2NTApe1xuICAgICAgdGhpcy5wbGF5bGlzdF9zaXplID0gMlxuICAgIH1cbiAgICBlbHNlIGlmKHdpZHRoIDwgOTAwKXtcbiAgICAgIHRoaXMucGxheWxpc3Rfc2l6ZSA9IDNcbiAgICB9XG4gICAgZWxzZSBpZih3aWR0aCA8IDEzMDApe1xuICAgICAgdGhpcy5wbGF5bGlzdF9zaXplID0gNVxuICAgIH1cbiAgICBlbHNlIGlmKHdpZHRoIDwgMjUwMCl7XG4gICAgICB0aGlzLnBsYXlsaXN0X3NpemUgPSA2XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnBsYXlsaXN0X3NpemUgPSA5ICAgICAgXG4gICAgfVxuXG4gICAgdGhpcy5wbGF5bGlzdF9pbmRleCA9IDAgICAgXG4gICAgdGhpcy51cGRhdGVQbGF5bGlzdCgpXG4gIH1cblxuXG4gIC8vdXBkYXRlIGZ1bmNcbiAgdG9nZ2xlU3RhdGUoKXtcbiAgICBpZih0aGlzLnZpZGVvLnBhdXNlZCl7XG4gICAgICB0aGlzLnZpZGVvLnBsYXkoKVxuICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgncGxheWluZycpXG4gICAgICB0aGlzLnJlbmRlcigpXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnZpZGVvLnBhdXNlKClcbiAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXlpbmcnKVxuICAgIH1cbiAgICB0aGlzLmVmZmVjdF9wYXVzZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgIHRoaXMuZWZmZWN0X3BsYXkuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgfVxuXG4gIHVwZGF0ZVRpbWUoZSl7XG4gICAgbGV0IHJhdGlvID0gKGUucGFnZVggLSB0aGlzLnRpbWVfcG9zaXRpb25zLmxlZnQpIC8gdGhpcy50aW1lX3Bvc2l0aW9ucy53aWR0aFxuICAgIGlmKHJhdGlvID49IDAgJiYgcmF0aW8gPCAxKXsgICAgICBcbiAgICAgIHRoaXMudGltZV9zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoJysgcmF0aW8gKycpJ1xuICAgICAgdGhpcy52aWRlby5jdXJyZW50VGltZSA9IHJhdGlvICogdGhpcy52aWRlby5kdXJhdGlvblxuICAgICAgdGhpcy50aW1lX2N1cnJlbnQudGV4dENvbnRlbnQgPSB0aGlzLmZvcm1hdFRpbWUodGhpcy52aWRlby5jdXJyZW50VGltZSlcbiAgICB9XG4gIH1cblxuICB1cGRhdGVWb2x1bWUoZSl7XG4gICAgbGV0IHJhdGlvID0gKGUucGFnZVggLSB0aGlzLnZvbHVtZV9wb3NpdGlvbnMubGVmdCkgLyB0aGlzLnZvbHVtZV9wb3NpdGlvbnMud2lkdGhcbiAgICAgIGlmKHJhdGlvID49IDAgJiYgcmF0aW8gPCAxKXtcbiAgICAgIHRoaXMudmlkZW8udm9sdW1lID0gcmF0aW9cbiAgICAgIHRoaXMudm9sdW1lX3NlZWtfYmFyX2ZpbGwuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlWCgnKyByYXRpbyArJyknICAgIFxuICAgICAgaWYodGhpcy52aWRlby5tdXRlZCl7XG4gICAgICAgIHRoaXMudG9nZ2xlTXV0ZSgpXG4gICAgICB9XG5cbiAgICAgIGlmKHJhdGlvID49IC41KXtcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5hZGQoJ3ZvbHVtZS0yJylcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ3ZvbHVtZS0xJylcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ3ZvbHVtZS0wJylcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYocmF0aW8gPCAuNSAmJiByYXRpbyA+PSAuMjUpe1xuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTInKVxuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LmFkZCgndm9sdW1lLTEnKVxuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTAnKVxuICAgICAgfVxuICAgICAgZWxzZSBpZihyYXRpbyA8IC4yNSl7XG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMicpXG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMScpXG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QuYWRkKCd2b2x1bWUtMCcpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKHJhdGlvIDw9IDApe1xuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTInKVxuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTEnKVxuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTAnKVxuICAgICAgICB0aGlzLnRvZ2dsZU11dGUoKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHRvZ2dsZU11dGUoKXtcbiAgICBpZih0aGlzLnZpZGVvLm11dGVkKXtcbiAgICAgIHRoaXMudmlkZW8ubXV0ZWQgPSBmYWxzZVxuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ211dGUnKVxuICAgICAgdGhpcy52b2x1bWVfc2Vla19iYXJfZmlsbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGVYKCcrIHRoaXMudmlkZW8udm9sdW1lICsnKScgICAgICAgICAgXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnZpZGVvLm11dGVkID0gdHJ1ZVxuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5hZGQoJ211dGUnKVxuICAgICAgdGhpcy52b2x1bWVfc2Vla19iYXJfZmlsbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGVYKDApJyAgICBcbiAgICB9XG4gIH1cblxuICB0b2dnbGVGdWxsc2NyZWVuKCl7XG4gICAgaWYoZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgPT0gbnVsbCAmJsKgZG9jdW1lbnQubW96RnVsbHNjcmVlbkVsZW1lbnQgPT0gbnVsbCAmJsKgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQgPT0gbnVsbCAmJiBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbGVtZW50PT0gbnVsbCApe1xuICAgICAgaWYodGhpcy5jb250YWluZXIucmVxdWVzdEZ1bGxzY3JlZW4pe1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZXF1ZXN0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKHRoaXMuY29udGFpbmVyLm1velJlcXVlc3RGdWxsU2NyZWVuKXtcbiAgICAgICAgdGhpcy5jb250YWluZXIubW96UmVxdWVzdEZ1bGxTY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZih0aGlzLmNvbnRhaW5lci53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbil7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYodGhpcy5jb250YWluZXIubXNSZXF1ZXN0RnVsbHNjcmVlbil7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLm1zUmVxdWVzdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgaWYoZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pe1xuICAgICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKGRvY3VtZW50Lm1vekV4aXRGdWxsU2NyZWVuKXtcbiAgICAgICAgZG9jdW1lbnQubW96RXhpdEZ1bGxTY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZihkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbil7XG4gICAgICAgIGRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYoZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbil7XG4gICAgICAgIGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vcGxheWxpc3RcbiAgdXBkYXRlUGxheWxpc3QoKXtcbiAgICB0aGlzLmNvbnRhaW5lcl9wbGF5bGlzdC5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKHRoaXMucGxheWxpc3RfaW5kZXggKiB0aGlzLnBsYXlsaXN0X2l0ZW1fd2lkdGgpICsncHgpJ1xuICAgIFxuICAgIGlmKHRoaXMucGxheWxpc3RfaW5kZXggPT0gMCl7XG4gICAgICB0aGlzLnBsYXlsaXN0X3ByZXYuY2xhc3NMaXN0LmFkZCgnaGlkZScpICAgICAgICAgIFxuICAgIH1cbiAgICBlbHNle1xuICAgICAgdGhpcy5wbGF5bGlzdF9wcmV2LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKSAgICAgICAgICBcbiAgICB9XG5cbiAgICBpZih0aGlzLnBsYXlsaXN0X2luZGV4ICA+PSAodGhpcy5wbGF5bGlzdF9pdGVtcy5sZW5ndGggLSB0aGlzLnBsYXlsaXN0X3NpemUpKXtcbiAgICAgIHRoaXMucGxheWxpc3RfbmV4dC5jbGFzc0xpc3QuYWRkKCdoaWRlJykgICAgICAgXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnBsYXlsaXN0X25leHQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpICAgIFxuICAgIH1cbiAgfVxuXG4gIHNlbGVjdFZpZGVvKCl7XG4gICAgdGhpcy5wbGF5bGlzdF9zZWxlY3RlZC5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgIHRoaXMucGxheWxpc3Rfc2VsZWN0ZWQgPSB0aGlzLnBsYXlsaXN0X2l0ZW1zW3RoaXMudmlkZW9faW5kZXhdXG4gICAgdGhpcy5wbGF5bGlzdF9zZWxlY3RlZC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuXG4gICAgdGhpcy52aWRlby5zcmMgPSB0aGlzLnBsYXlsaXN0X3NlbGVjdGVkLmRhdGFzZXQudGFyZ2V0XG4gICAgdGhpcy5pbml0KClcblxuICAgIGlmKHRoaXMudmlkZW9faW5kZXggPiB0aGlzLnBsYXlsaXN0X2luZGV4ICsgdGhpcy5wbGF5bGlzdF9zaXplIC0gMSl7XG4gICAgICB0aGlzLnBsYXlsaXN0X2luZGV4KytcbiAgICAgIHRoaXMudXBkYXRlUGxheWxpc3QoKVxuICAgIH1cbiAgICBlbHNlIGlmKHRoaXMudmlkZW9faW5kZXggPCB0aGlzLnBsYXlsaXN0X2luZGV4KXtcbiAgICAgIHRoaXMucGxheWxpc3RfaW5kZXgtLVxuICAgICAgdGhpcy51cGRhdGVQbGF5bGlzdCgpICAgICAgXG4gICAgfVxuXG4gICAgaWYodGhpcy52aWRlb19pbmRleCA9PSAwKXtcbiAgICAgIHRoaXMudmlkZW9fcHJldi5jbGFzc0xpc3QuYWRkKCdoaWRlJykgICAgICAgICAgXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnZpZGVvX3ByZXYuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpICAgICAgICAgIFxuICAgIH1cblxuICAgIGlmKHRoaXMudmlkZW9faW5kZXggID49ICh0aGlzLnBsYXlsaXN0X2l0ZW1zLmxlbmd0aCAtIDEpKXtcbiAgICAgIHRoaXMudmlkZW9fbmV4dC5jbGFzc0xpc3QuYWRkKCdoaWRlJykgICAgICAgXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnZpZGVvX25leHQuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpICAgIFxuICAgIH1cbiAgfVxuICBcblxuXG4gIC8vcmVuZGVyIGZ1bmNcbiAgcmVuZGVyKCl7XG4gICAgaWYoIXRoaXMudmlkZW8ucGF1c2VkKXtcbiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXIuYmluZCh0aGlzKSlcbiAgICB9XG5cbiAgICBsZXQgcmF0aW8gPSB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lIC8gdGhpcy52aWRlby5kdXJhdGlvblxuICAgIHRoaXMudGltZV9zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoJysgcmF0aW8gKycpJ1xuXG4gICAgdGhpcy50aW1lX2N1cnJlbnQudGV4dENvbnRlbnQgPSB0aGlzLmZvcm1hdFRpbWUodGhpcy52aWRlby5jdXJyZW50VGltZSlcbiAgICBcbiAgICBpZih0aGlzLnZpZGVvLmN1cnJlbnRUaW1lID09IHRoaXMudmlkZW8uZHVyYXRpb24pe1xuICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgncGxheWluZycpICAgICAgXG4gICAgfVxuICB9XG5cblxuICAvLyB1c2VmdWxsIGZ1bmNcbiAgZm9ybWF0VGltZSh0aW1lKXtcbiAgICB0aW1lICA9IE1hdGgucm91bmQodGltZSlcbiAgICBsZXQgaG91cnMgICA9IE1hdGguZmxvb3IodGltZSAvIDM2MDApO1xuICAgIGxldCBtaW51dGVzID0gTWF0aC5mbG9vcigodGltZSAtIChob3VycyAqIDM2MDApKSAvIDYwKTtcbiAgICBsZXQgc2Vjb25kcyA9IHRpbWUgLSAoaG91cnMgKiAzNjAwKSAtIChtaW51dGVzICogNjApO1xuXG4gICAgaG91cnMgICA9IGhvdXJzICAgPCAxMCA/IFwiMFwiK2hvdXJzIDogaG91cnNcbiAgICBtaW51dGVzID0gbWludXRlcyA8IDEwID8gXCIwXCIrbWludXRlcyA6IG1pbnV0ZXNcbiAgICBzZWNvbmRzID0gc2Vjb25kcyA8IDEwID8gXCIwXCIrc2Vjb25kcyA6IHNlY29uZHNcblxuICAgIGlmKGhvdXJzICE9IDApe1xuICAgICAgcmV0dXJuIGhvdXJzKyc6JyttaW51dGVzKyc6JytzZWNvbmRzXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICByZXR1cm4gbWludXRlcysnOicrc2Vjb25kc1xuICAgIH1cbiAgfVxufSIsIi8vIEhFQURFUiBCVVJHRVJcbmNvbnN0IGJ1cmdlcl9idXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyLWJ1cmdlcicpXG5jb25zdCBidXJnZXJfbmF2ICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlci1uYXYnKVxuXG5idXJnZXJfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgYnVyZ2VyX2J1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItYnVyZ2VyLWFjdGl2ZScpXG4gIGJ1cmdlcl9uYXYuY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLW5hdi1leHBhbmQnKVxufSlcblxuY29uc3QgaGVhZGVyICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcicpXG5sZXQgaGVhZGVyX2hpZGUgPSBmYWxzZVxuZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXdoZWVsJywgZnVuY3Rpb24oZSl7XG4gIGlmKCFoZWFkZXJfaGlkZSAmJiBlLmRlbHRhWSA8IDAgJiYgIXNjcm9sbF9kaXNhYmxlZCl7XG4gICAgaGVhZGVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKVxuICAgIGhlYWRlcl9oaWRlID0gdHJ1ZVxuICB9XG4gIGVsc2UgaWYoaGVhZGVyX2hpZGUgJiYgZS5kZWx0YVkgPiAwICYmIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID4gODAgJiYgIXNjcm9sbF9kaXNhYmxlZCl7XG4gICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKSAgICBcbiAgICBoZWFkZXJfaGlkZSA9IGZhbHNlXG4gIH1cbn0pXG5cbi8vIFNDUk9MTCBESVNBQkxFXG5jb25zdCBkaXNhYmxlZF9lbGVtZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY3JvbGwtZGlzYWJsZScpXG5sZXQgc2Nyb2xsX2Rpc2FibGVkICAgICA9IGZhbHNlXG5mb3IgKHZhciBpID0gMDsgaSA8IGRpc2FibGVkX2VsZW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gIGRpc2FibGVkX2VsZW1lbnRzW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCAoKT0+e1xuICAgIHNjcm9sbF9kaXNhYmxlZCA9IHRydWVcbiAgfSlcbiAgZGlzYWJsZWRfZWxlbWVudHNbaV0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpPT57XG4gICAgc2Nyb2xsX2Rpc2FibGVkID0gZmFsc2VcbiAgfSlcbn1cblxuXG5cbi8vIEVYSElCSVRJT05TIFNMSURFUlxuaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tZXhoaWJpdGlvbnMnKSAhPSB1bmRlZmluZWQpe1xuICBjb25zdCBleGhpYml0aW9uc19idXR0b25zX2l0ZW0gICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWN0aW9uLWV4aGliaXRpb25zLWNvbnRhaW5lci1zbGlkZXItbmF2LWxpc3QtLWl0ZW0nKVxuICBjb25zdCBleGhpYml0aW9uc19idXR0b25zX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLWV4aGliaXRpb25zLWNvbnRhaW5lci1zbGlkZXItbmF2LWxpc3QnKVxuICBjb25zdCBleGhpYml0aW9uc19saXN0X2ltZyAgICAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLWV4aGliaXRpb25zLWNvbnRhaW5lci1zbGlkZXItd3JhcHBlci1saXN0JylcbiAgY29uc3QgZXhoaWJpdGlvbnNfbGlzdF9jb250ZW50ICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi1leGhpYml0aW9ucy1jb250YWluZXItY29udGVudC13cmFwcGVyLWxpc3QnKVxuICBsZXQgZXhoaWJpdGlvbnNfbGFzdF9pbmRleCAgICAgICAgICA9IDBcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbS5sZW5ndGg7IGkrKykge1xuICAgIGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbVtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICBsZXQgaW5kZXggPSBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbSwgdGhpcylcblxuICAgICAgaWYoZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtW2V4aGliaXRpb25zX2xhc3RfaW5kZXhdICE9IHVuZGVmaW5lZCl7XG4gICAgICAgIGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbVtleGhpYml0aW9uc19sYXN0X2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgICAgfVxuICAgICAgZXhoaWJpdGlvbnNfbGFzdF9pbmRleCA9IGluZGV4XG5cbiAgICAgIGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbVtpbmRleF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcblxuICAgICAgaWYod2luZG93LmlubmVyV2lkdGggPj0gOTAwKXtcbiAgICAgICAgZXhoaWJpdGlvbnNfbGlzdF9pbWcuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoLScrIChpbmRleCAqIDEwMCkgKyclKSdcbiAgICAgICAgZXhoaWJpdGlvbnNfbGlzdF9jb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAoaW5kZXggKiAxMDApICsnJSknXG4gICAgICB9XG4gICAgICBlbHNle1xuICAgICAgICBleGhpYml0aW9uc19saXN0X2ltZy5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKGluZGV4ICogMTAwKSArJyUpJ1xuICAgICAgICBleGhpYml0aW9uc19saXN0X2NvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoLScrIChpbmRleCAqIDEwMCkgKyclKSdcbiAgICAgICAgZXhoaWJpdGlvbnNfYnV0dG9uc19jb250YWluZXIuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoLScrICgoKGluZGV4LTEpLzMpICogMTAwKSArJyUpJ1xuICAgICAgfVxuXG4gICAgfSlcbiAgfVxufVxuXG4vLyBIT01FIFBMQVlFUilcbmlmKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyJykgIT0gdW5kZWZpbmVkKXtcbiAgY29uc3QgcGxheWVyID0gbmV3IFBsYXllcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlcicpLCB0cnVlKVxufSJdfQ==