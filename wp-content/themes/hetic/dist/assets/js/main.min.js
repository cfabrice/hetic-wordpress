"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),Controller=function(){function e(t){var i=this;_classCallCheck(this,e),this.container=t,this.button_toggle=this.container.querySelector(".section-videos-wrapper-controls--toggle"),this.video=this.container.querySelector(".section-videos-wrapper-video"),this.seek_bar=this.container.querySelector(".section-videos-wrapper-controls-seek-bar"),this.seek_bar_fill=this.seek_bar.querySelector(".section-videos-wrapper-controls-seek-bar--fill"),this.time_current=this.container.querySelector(".section-videos-wrapper-controls--time-current"),this.time_duration=this.container.querySelector(".section-videos-wrapper-controls--time-duration"),this.time_drag=!1,this.button_volume=this.container.querySelector(".section-videos-wrapper-controls-volume--icon"),this.button_fullscreen=this.container.querySelector(".section-videos-wrapper-controls--fullscreen"),this.time_duration.textContent=this.video.duration,this.button_toggle.addEventListener("click",function(){i.toggleState()}),this.seek_bar.addEventListener("click",function(e){i.container_positions=i.seek_bar.getBoundingClientRect(),i.updateTime(e)}),this.seek_bar.addEventListener("mousedown",function(){i.time_drag||(i.container_positions=i.seek_bar.getBoundingClientRect(),i.time_drag=!0)}),window.addEventListener("mouseup",function(){i.time_drag&&(i.time_drag=!1)}),window.addEventListener("mousemove",function(e){i.time_drag&&i.updateTime(e)}),this.button_volume.addEventListener("click",function(){i.video.muted?(i.video.muted=!1,i.button_volume.classList.remove("mute")):(i.video.muted=!0,i.button_volume.classList.add("mute"))}),this.button_fullscreen.addEventListener("click",function(){i.toggleFullscreen()})}return _createClass(e,[{key:"init",value:function(){var e=this;this.video.addEventListener("loadeddata",function(){e.video.pause(),e.video.volume=.5,e.video.currentTime=0,e.time_duration.textContent=e.formatTime(e.video.duration),e.time_current.textContent=e.formatTime(e.video.currentTime),e.seek_bar_fill.style.transform="scaleX(0)"})}},{key:"toggleState",value:function(){this.video.paused?(this.video.play(),this.container.classList.add("playing"),this.render()):(this.video.pause(),this.container.classList.remove("playing"))}},{key:"updateTime",value:function(e){var t=(e.pageX-this.container_positions.left)/this.container_positions.width;this.seek_bar_fill.style.transform="scaleX("+t+")",this.video.currentTime=t*this.video.duration,this.time_current.textContent=this.formatTime(this.video.currentTime)}},{key:"toggleFullscreen",value:function(){null==document.fullscreenElement&&null==document.mozFullscreenElement&&null==document.webkitFullscreenElement&&null==document.msFullscreenElement?this.container.requestFullscreen?this.container.requestFullscreen():this.container.mozRequestFullScreen?this.container.mozRequestFullScreen():this.container.webkitRequestFullscreen?this.container.webkitRequestFullscreen():this.container.msRequestFullscreen&&this.container.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}},{key:"render",value:function(){this.video.paused||window.requestAnimationFrame(this.render.bind(this));var e=this.video.currentTime/this.video.duration;this.seek_bar_fill.style.transform="scaleX("+e+")",this.time_current.textContent=this.formatTime(this.video.currentTime),this.video.currentTime==this.video.duration&&this.container.classList.remove("playing")}},{key:"formatTime",value:function(e){e=Math.round(e);var t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),n=e-3600*t-60*i;return t=t<10?"0"+t:t,i=i<10?"0"+i:i,n=n<10?"0"+n:n,0!=t?t+":"+i+":"+n:i+":"+n}}]),e}(),controller=new Controller(document.querySelector(".section-videos-wrapper"));controller.init(),console.log(controller);var burger_button=document.querySelector(".header-burger"),burger_nav=document.querySelector(".header-nav");burger_button.addEventListener("click",function(){burger_button.classList.toggle("header-burger-active"),burger_nav.classList.toggle("header-nav-expand")});for(var exhibitions_buttons_item=document.querySelectorAll(".section-exhibitions-container-slider-nav-list--item"),exhibitions_buttons_container=document.querySelector(".section-exhibitions-container-slider-nav-list"),exhibitions_list_img=document.querySelector(".section-exhibitions-container-slider-wrapper-list"),exhibitions_list_content=document.querySelector(".section-exhibitions-container-content-wrapper-list"),exhibitions_last_index=0,i=0;i<exhibitions_buttons_item.length;i++)exhibitions_buttons_item[i].addEventListener("click",function(){var e=Array.prototype.indexOf.call(exhibitions_buttons_item,this);void 0!=exhibitions_buttons_item[exhibitions_last_index]&&exhibitions_buttons_item[exhibitions_last_index].classList.remove("active"),exhibitions_last_index=e,exhibitions_buttons_item[e].classList.add("active"),window.innerWidth>=900?(exhibitions_list_img.style.transform="translateX(-"+100*e+"%)",exhibitions_list_content.style.transform="translateX(-"+100*e+"%)"):(exhibitions_list_img.style.transform="translateX(-"+100*e+"%)",exhibitions_list_content.style.transform="translateX(-"+100*e+"%)",exhibitions_buttons_container.style.transform="translateX(-"+(e-1)/3*100+"%)")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnRyb2xsZXIuanMiLCJtYWluLmpzIl0sIm5hbWVzIjpbIkNvbnRyb2xsZXIiLCJjb250YWluZXIiLCJfdGhpcyIsInRoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJidXR0b25fdG9nZ2xlIiwicXVlcnlTZWxlY3RvciIsInZpZGVvIiwic2Vla19iYXIiLCJzZWVrX2Jhcl9maWxsIiwidGltZV9jdXJyZW50IiwidGltZV9kdXJhdGlvbiIsInRpbWVfZHJhZyIsImJ1dHRvbl92b2x1bWUiLCJidXR0b25fZnVsbHNjcmVlbiIsInRleHRDb250ZW50IiwiZHVyYXRpb24iLCJhZGRFdmVudExpc3RlbmVyIiwidG9nZ2xlU3RhdGUiLCJlIiwiY29udGFpbmVyX3Bvc2l0aW9ucyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInVwZGF0ZVRpbWUiLCJ3aW5kb3ciLCJtdXRlZCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFkZCIsInRvZ2dsZUZ1bGxzY3JlZW4iLCJfdGhpczIiLCJwYXVzZSIsInZvbHVtZSIsImN1cnJlbnRUaW1lIiwiZm9ybWF0VGltZSIsInN0eWxlIiwidHJhbnNmb3JtIiwicGF1c2VkIiwicGxheSIsInJlbmRlciIsInJhdGlvIiwicGFnZVgiLCJsZWZ0Iiwid2lkdGgiLCJkb2N1bWVudCIsImZ1bGxzY3JlZW5FbGVtZW50IiwibW96RnVsbHNjcmVlbkVsZW1lbnQiLCJ3ZWJraXRGdWxsc2NyZWVuRWxlbWVudCIsIm1zRnVsbHNjcmVlbkVsZW1lbnQiLCJyZXF1ZXN0RnVsbHNjcmVlbiIsIm1velJlcXVlc3RGdWxsU2NyZWVuIiwid2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4iLCJtc1JlcXVlc3RGdWxsc2NyZWVuIiwiZXhpdEZ1bGxzY3JlZW4iLCJtb3pFeGl0RnVsbFNjcmVlbiIsIndlYmtpdEV4aXRGdWxsc2NyZWVuIiwibXNFeGl0RnVsbHNjcmVlbiIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImJpbmQiLCJ0aW1lIiwiTWF0aCIsInJvdW5kIiwiaG91cnMiLCJmbG9vciIsIm1pbnV0ZXMiLCJzZWNvbmRzIiwiY29udHJvbGxlciIsImluaXQiLCJjb25zb2xlIiwibG9nIiwiYnVyZ2VyX2J1dHRvbiIsImJ1cmdlcl9uYXYiLCJ0b2dnbGUiLCJleGhpYml0aW9uc19idXR0b25zX2l0ZW0iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZXhoaWJpdGlvbnNfYnV0dG9uc19jb250YWluZXIiLCJleGhpYml0aW9uc19saXN0X2ltZyIsImV4aGliaXRpb25zX2xpc3RfY29udGVudCIsImV4aGliaXRpb25zX2xhc3RfaW5kZXgiLCJpIiwibGVuZ3RoIiwiaW5kZXgiLCJBcnJheSIsInByb3RvdHlwZSIsImluZGV4T2YiLCJjYWxsIiwidW5kZWZpbmVkIiwiaW5uZXJXaWR0aCJdLCJtYXBwaW5ncyI6IjZYQUFNQSxXQUFBQSxXQUNKLFNBQUFBLEVBQVlDLEdBQVUsSUFBQUMsRUFBQUMsS0FBQUMsZ0JBQUFELEtBQUFILEdBQ3BCRyxLQUFLRixVQUFnQkEsRUFDckJFLEtBQUtFLGNBQWdCRixLQUFLRixVQUFVSyxjQUFjLDRDQUNsREgsS0FBS0ksTUFBZ0JKLEtBQUtGLFVBQVVLLGNBQWMsaUNBQ2xESCxLQUFLSyxTQUFnQkwsS0FBS0YsVUFBVUssY0FBYyw2Q0FDbERILEtBQUtNLGNBQWdCTixLQUFLSyxTQUFTRixjQUFjLG1EQUNqREgsS0FBS08sYUFBZ0JQLEtBQUtGLFVBQVVLLGNBQWMsa0RBQ2xESCxLQUFLUSxjQUFnQlIsS0FBS0YsVUFBVUssY0FBYyxtREFDbERILEtBQUtTLFdBQWdCLEVBQ3JCVCxLQUFLVSxjQUFnQlYsS0FBS0YsVUFBVUssY0FBYyxpREFDbERILEtBQUtXLGtCQUFvQlgsS0FBS0YsVUFBVUssY0FBYyxnREFFdERILEtBQUtRLGNBQWNJLFlBQWNaLEtBQUtJLE1BQU1TLFNBRTVDYixLQUFLRSxjQUFjWSxpQkFBaUIsUUFBUyxXQUMzQ2YsRUFBS2dCLGdCQUdQZixLQUFLSyxTQUFTUyxpQkFBaUIsUUFBUyxTQUFDRSxHQUN2Q2pCLEVB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LElBQVI2QyxFQUFjLEtBQ3RFSix5QkFBeUIxQyxNQUFNQyxVQUFZLGVBQXlCLElBQVI2QyxFQUFjLE9BRzFFTCxxQkFBcUJ6QyxNQUFNQyxVQUFZLGVBQXlCLElBQVI2QyxFQUFjLEtBQ3RFSix5QkFBeUIxQyxNQUFNQyxVQUFZLGVBQXlCLElBQVI2QyxFQUFjLEtBQzFFTiw4QkFBOEJ4QyxNQUFNQyxVQUFZLGdCQUFtQjZDLEVBQU0sR0FBRyxFQUFLLElBQU0iLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBDb250cm9sbGVye1xuICBjb25zdHJ1Y3Rvcihjb250YWluZXIpe1xuICAgIHRoaXMuY29udGFpbmVyICAgICA9IGNvbnRhaW5lclxuICAgIHRoaXMuYnV0dG9uX3RvZ2dsZSA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLS10b2dnbGUnKVxuICAgIHRoaXMudmlkZW8gICAgICAgICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLXZpZGVvJylcbiAgICB0aGlzLnNlZWtfYmFyICAgICAgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy1zZWVrLWJhcicpXG4gICAgdGhpcy5zZWVrX2Jhcl9maWxsID0gdGhpcy5zZWVrX2Jhci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy1zZWVrLWJhci0tZmlsbCcpXG4gICAgdGhpcy50aW1lX2N1cnJlbnQgID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLXRpbWUtY3VycmVudCcpXG4gICAgdGhpcy50aW1lX2R1cmF0aW9uID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLXRpbWUtZHVyYXRpb24nKVxuICAgIHRoaXMudGltZV9kcmFnICAgICA9IGZhbHNlXG4gICAgdGhpcy5idXR0b25fdm9sdW1lID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtdm9sdW1lLS1pY29uJylcbiAgICB0aGlzLmJ1dHRvbl9mdWxsc2NyZWVuID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLWZ1bGxzY3JlZW4nKSAgICBcblxuICAgIHRoaXMudGltZV9kdXJhdGlvbi50ZXh0Q29udGVudCA9IHRoaXMudmlkZW8uZHVyYXRpb24gICAgXG5cbiAgICB0aGlzLmJ1dHRvbl90b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xuICAgICAgdGhpcy50b2dnbGVTdGF0ZSgpXG4gICAgfSlcblxuICAgIHRoaXMuc2Vla19iYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PntcbiAgICAgIHRoaXMuY29udGFpbmVyX3Bvc2l0aW9ucyA9IHRoaXMuc2Vla19iYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIFxuICAgICAgdGhpcy51cGRhdGVUaW1lKGUpXG5cbiAgICAgIC8vIGlmKHRoaXMudmlkZW8ucGF1c2VkKXtcbiAgICAgIC8vICAgdGhpcy50b2dnbGVTdGF0ZSgpXG4gICAgICAvLyB9XG4gICAgfSlcblxuICAgIHRoaXMuc2Vla19iYXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCk9PntcbiAgICAgIGlmKCF0aGlzLnRpbWVfZHJhZyl7XG4gICAgICAgIHRoaXMuY29udGFpbmVyX3Bvc2l0aW9ucyA9IHRoaXMuc2Vla19iYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgICAgICBcbiAgICAgICAgdGhpcy50aW1lX2RyYWcgPSB0cnVlXG4gICAgICB9XG4gICAgfSlcblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKCk9PntcbiAgICAgIGlmKHRoaXMudGltZV9kcmFnKXtcbiAgICAgICAgdGhpcy50aW1lX2RyYWcgPSBmYWxzZVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpPT57XG4gICAgICBpZih0aGlzLnRpbWVfZHJhZyl7XG4gICAgICAgIHRoaXMudXBkYXRlVGltZShlKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLmJ1dHRvbl92b2x1bWUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PntcbiAgICAgIGlmKHRoaXMudmlkZW8ubXV0ZWQpe1xuICAgICAgICB0aGlzLnZpZGVvLm11dGVkID0gZmFsc2VcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ211dGUnKVxuICAgICAgfVxuICAgICAgZWxzZXtcbiAgICAgICAgdGhpcy52aWRlby5tdXRlZCA9IHRydWVcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5hZGQoJ211dGUnKSAgICAgICAgXG4gICAgICB9XG4gICAgfSlcblxuXG4gICAgdGhpcy5idXR0b25fZnVsbHNjcmVlbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgICB0aGlzLnRvZ2dsZUZ1bGxzY3JlZW4oKVxuICAgIH0pXG4gIH1cblxuICAvLyBpbml0IG5ldyB2aWRlb1xuICBpbml0KCl7XG4gICAgdGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRkYXRhJywgKCkgPT57XG4gICAgICB0aGlzLnZpZGVvLnBhdXNlKClcbiAgICAgIHRoaXMudmlkZW8udm9sdW1lID0gLjUgICAgXG4gICAgICB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lID0gMFxuICAgICAgdGhpcy50aW1lX2R1cmF0aW9uLnRleHRDb250ZW50ID0gdGhpcy5mb3JtYXRUaW1lKHRoaXMudmlkZW8uZHVyYXRpb24pICAgXG4gICAgICB0aGlzLnRpbWVfY3VycmVudC50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmN1cnJlbnRUaW1lKSAgICAgICBcbiAgICAgIFxuICAgICAgdGhpcy5zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoMCknICAgIFxuICAgIH0pICAgIFxuICB9XG5cblxuICAvL3VwZGF0ZSBmdW5jXG4gIHRvZ2dsZVN0YXRlKCl7XG4gICAgaWYodGhpcy52aWRlby5wYXVzZWQpe1xuICAgICAgdGhpcy52aWRlby5wbGF5KClcbiAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3BsYXlpbmcnKVxuICAgICAgdGhpcy5yZW5kZXIoKVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgdGhpcy52aWRlby5wYXVzZSgpXG4gICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5aW5nJylcbiAgICB9XG4gIH1cblxuICB1cGRhdGVUaW1lKGUpe1xuICAgIGxldCByYXRpbyA9IChlLnBhZ2VYIC0gdGhpcy5jb250YWluZXJfcG9zaXRpb25zLmxlZnQpIC8gdGhpcy5jb250YWluZXJfcG9zaXRpb25zLndpZHRoXG4gICAgdGhpcy5zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoJysgcmF0aW8gKycpJ1xuICAgIHRoaXMudmlkZW8uY3VycmVudFRpbWUgPSByYXRpbyAqIHRoaXMudmlkZW8uZHVyYXRpb25cbiAgICB0aGlzLnRpbWVfY3VycmVudC50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmN1cnJlbnRUaW1lKVxuICB9XG5cbiAgdG9nZ2xlRnVsbHNjcmVlbigpe1xuICAgIGlmKGRvY3VtZW50LmZ1bGxzY3JlZW5FbGVtZW50ID09IG51bGwgJibCoGRvY3VtZW50Lm1vekZ1bGxzY3JlZW5FbGVtZW50ID09IG51bGwgJibCoGRvY3VtZW50LndlYmtpdEZ1bGxzY3JlZW5FbGVtZW50ID09IG51bGwgJiYgZG9jdW1lbnQubXNGdWxsc2NyZWVuRWxlbWVudD09IG51bGwgKXtcbiAgICAgIGlmKHRoaXMuY29udGFpbmVyLnJlcXVlc3RGdWxsc2NyZWVuKXtcbiAgICAgICAgdGhpcy5jb250YWluZXIucmVxdWVzdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZih0aGlzLmNvbnRhaW5lci5tb3pSZXF1ZXN0RnVsbFNjcmVlbil7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLm1velJlcXVlc3RGdWxsU2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYodGhpcy5jb250YWluZXIud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4pe1xuICAgICAgICB0aGlzLmNvbnRhaW5lci53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKHRoaXMuY29udGFpbmVyLm1zUmVxdWVzdEZ1bGxzY3JlZW4pe1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5tc1JlcXVlc3RGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGlmKGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKXtcbiAgICAgICAgZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZihkb2N1bWVudC5tb3pFeGl0RnVsbFNjcmVlbil7XG4gICAgICAgIGRvY3VtZW50Lm1vekV4aXRGdWxsU2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYoZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4pe1xuICAgICAgICBkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4pe1xuICAgICAgICBkb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gIC8vcmVuZGVyIGZ1bmNcbiAgcmVuZGVyKCl7XG4gICAgaWYoIXRoaXMudmlkZW8ucGF1c2VkKXtcbiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXIuYmluZCh0aGlzKSlcbiAgICB9XG5cbiAgICBsZXQgcmF0aW8gPSB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lIC8gdGhpcy52aWRlby5kdXJhdGlvblxuICAgIHRoaXMuc2Vla19iYXJfZmlsbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGVYKCcrIHJhdGlvICsnKSdcblxuICAgIHRoaXMudGltZV9jdXJyZW50LnRleHRDb250ZW50ID0gdGhpcy5mb3JtYXRUaW1lKHRoaXMudmlkZW8uY3VycmVudFRpbWUpXG4gICAgXG4gICAgaWYodGhpcy52aWRlby5jdXJyZW50VGltZSA9PSB0aGlzLnZpZGVvLmR1cmF0aW9uKXtcbiAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXlpbmcnKSAgICAgIFxuICAgIH1cbiAgfVxuXG5cbiAgLy8gdXNlZnVsbCBmdW5jXG4gIGZvcm1hdFRpbWUodGltZSl7XG4gICAgdGltZSAgPSBNYXRoLnJvdW5kKHRpbWUpXG4gICAgbGV0IGhvdXJzICAgPSBNYXRoLmZsb29yKHRpbWUgLyAzNjAwKTtcbiAgICBsZXQgbWludXRlcyA9IE1hdGguZmxvb3IoKHRpbWUgLSAoaG91cnMgKiAzNjAwKSkgLyA2MCk7XG4gICAgbGV0IHNlY29uZHMgPSB0aW1lIC0gKGhvdXJzICogMzYwMCkgLSAobWludXRlcyAqIDYwKTtcblxuICAgIGhvdXJzICAgPSBob3VycyAgIDwgMTAgPyBcIjBcIitob3VycyA6IGhvdXJzXG4gICAgbWludXRlcyA9IG1pbnV0ZXMgPCAxMCA/IFwiMFwiK21pbnV0ZXMgOiBtaW51dGVzXG4gICAgc2Vjb25kcyA9IHNlY29uZHMgPCAxMCA/IFwiMFwiK3NlY29uZHMgOiBzZWNvbmRzXG5cbiAgICBpZihob3VycyAhPSAwKXtcbiAgICAgIHJldHVybiBob3VycysnOicrbWludXRlcysnOicrc2Vjb25kc1xuICAgIH1cbiAgICBlbHNle1xuICAgICAgcmV0dXJuIG1pbnV0ZXMrJzonK3NlY29uZHNcbiAgICB9XG4gIH1cbn1cblxuY29uc3QgY29udHJvbGxlciA9IG5ldyBDb250cm9sbGVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyJykpXG5jb250cm9sbGVyLmluaXQoKVxuY29uc29sZS5sb2coY29udHJvbGxlcikiLCJjb25zdCBidXJnZXJfYnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlci1idXJnZXInKVxuY29uc3QgYnVyZ2VyX25hdiAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXItbmF2JylcblxuYnVyZ2VyX2J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gIGJ1cmdlcl9idXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnaGVhZGVyLWJ1cmdlci1hY3RpdmUnKVxuICBidXJnZXJfbmF2LmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1uYXYtZXhwYW5kJylcbn0pXG5cblxuXG5jb25zdCBleGhpYml0aW9uc19idXR0b25zX2l0ZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VjdGlvbi1leGhpYml0aW9ucy1jb250YWluZXItc2xpZGVyLW5hdi1saXN0LS1pdGVtJylcbmNvbnN0IGV4aGliaXRpb25zX2J1dHRvbnNfY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tZXhoaWJpdGlvbnMtY29udGFpbmVyLXNsaWRlci1uYXYtbGlzdCcpXG5jb25zdCBleGhpYml0aW9uc19saXN0X2ltZyAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi1leGhpYml0aW9ucy1jb250YWluZXItc2xpZGVyLXdyYXBwZXItbGlzdCcpXG5jb25zdCBleGhpYml0aW9uc19saXN0X2NvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi1leGhpYml0aW9ucy1jb250YWluZXItY29udGVudC13cmFwcGVyLWxpc3QnKVxubGV0IGV4aGliaXRpb25zX2xhc3RfaW5kZXggPSAwXG5cbmZvciAodmFyIGkgPSAwOyBpIDwgZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtLmxlbmd0aDsgaSsrKSB7XG4gIGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbVtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgbGV0IGluZGV4ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChleGhpYml0aW9uc19idXR0b25zX2l0ZW0sIHRoaXMpXG5cbiAgICBpZihleGhpYml0aW9uc19idXR0b25zX2l0ZW1bZXhoaWJpdGlvbnNfbGFzdF9pbmRleF0gIT0gdW5kZWZpbmVkKXtcbiAgICAgIGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbVtleGhpYml0aW9uc19sYXN0X2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgIH1cbiAgICBleGhpYml0aW9uc19sYXN0X2luZGV4ID0gaW5kZXhcblxuICAgIGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbVtpbmRleF0uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcblxuXG4gICAgaWYod2luZG93LmlubmVyV2lkdGggPj0gOTAwKXtcbiAgICAgIGV4aGliaXRpb25zX2xpc3RfaW1nLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAoaW5kZXggKiAxMDApICsnJSknXG4gICAgICBleGhpYml0aW9uc19saXN0X2NvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoLScrIChpbmRleCAqIDEwMCkgKyclKSdcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIGV4aGliaXRpb25zX2xpc3RfaW1nLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAoaW5kZXggKiAxMDApICsnJSknXG4gICAgICBleGhpYml0aW9uc19saXN0X2NvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoLScrIChpbmRleCAqIDEwMCkgKyclKSdcbiAgICAgIGV4aGliaXRpb25zX2J1dHRvbnNfY29udGFpbmVyLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAoKChpbmRleC0xKS8zKSAqIDEwMCkgKyclKSdcbiAgICB9XG4gIH0pXG59Il19
