"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),Controller=function(){function e(t){var i=this;_classCallCheck(this,e),this.container=t,this.button_toggle=this.container.querySelector(".section-videos-wrapper-controls--toggle"),this.video=this.container.querySelector(".section-videos-wrapper-video"),this.time_seek_bar=this.container.querySelector(".section-videos-wrapper-controls-seek-bar"),this.time_seek_bar_fill=this.time_seek_bar.querySelector(".section-videos-wrapper-controls-seek-bar--fill"),this.time_drag=!1,this.time_current=this.container.querySelector(".section-videos-wrapper-controls--time-current"),this.time_duration=this.container.querySelector(".section-videos-wrapper-controls--time-duration"),this.button_volume=this.container.querySelector(".section-videos-wrapper-controls-volume--icon"),this.volume_seek_bar=this.container.querySelector(".section-videos-wrapper-controls-volume--bar"),this.volume_seek_bar_fill=this.container.querySelector(".section-videos-wrapper-controls-volume--bar-fill"),this.volume_drag=!1,this.effect_pause=this.container.querySelector(".section-videos-wrapper-effect-pause"),this.effect_play=this.container.querySelector(".section-videos-wrapper-effect-play"),this.button_fullscreen=this.container.querySelector(".section-videos-wrapper-controls--fullscreen"),this.button_toggle.addEventListener("click",function(){i.toggleState()}),this.time_seek_bar.addEventListener("click",function(e){i.time_positions=i.time_seek_bar.getBoundingClientRect(),i.updateTime(e)}),this.time_seek_bar.addEventListener("mousedown",function(){i.time_drag||(i.time_positions=i.time_seek_bar.getBoundingClientRect(),i.time_drag=!0)}),window.addEventListener("mouseup",function(){i.time_drag&&(i.time_drag=!1),i.volume_drag&&(i.volume_drag=!1)}),window.addEventListener("mousemove",function(e){i.time_drag&&i.updateTime(e),i.volume_drag&&i.updateVolume(e)}),this.button_volume.addEventListener("click",function(){i.toggleMute()}),this.volume_seek_bar.addEventListener("click",function(e){i.volume_positions=i.volume_seek_bar.getBoundingClientRect(),i.updateVolume(e)}),this.volume_seek_bar.addEventListener("mousedown",function(){i.volume_drag||(i.volume_positions=i.volume_seek_bar.getBoundingClientRect(),i.volume_drag=!0)}),this.button_fullscreen.addEventListener("click",function(){i.toggleFullscreen()}),this.video.addEventListener("dblclick",function(){i.toggleFullscreen()}),this.video.addEventListener("click",function(){i.toggleState(),i.video.paused?(i.effect_play.classList.add("active"),i.effect_pause.classList.remove("active")):(i.effect_pause.classList.add("active"),i.effect_play.classList.remove("active"))})}return _createClass(e,[{key:"init",value:function(){var e=this;this.video.addEventListener("loadeddata",function(){e.video.pause(),e.video.currentTime=0,e.time_duration.textContent=e.formatTime(e.video.duration),e.time_current.textContent=e.formatTime(e.video.currentTime),e.time_seek_bar_fill.style.transform="scaleX(0)"})}},{key:"toggleState",value:function(){this.video.paused?(this.video.play(),this.container.classList.add("playing"),this.render()):(this.video.pause(),this.container.classList.remove("playing")),this.effect_pause.classList.remove("active"),this.effect_play.classList.remove("active")}},{key:"updateTime",value:function(e){var t=(e.pageX-this.time_positions.left)/this.time_positions.width;this.time_seek_bar_fill.style.transform="scaleX("+t+")",this.video.currentTime=t*this.video.duration,this.time_current.textContent=this.formatTime(this.video.currentTime)}},{key:"updateVolume",value:function(e){var t=(e.pageX-this.volume_positions.left)/this.volume_positions.width;this.video.volume=t,this.volume_seek_bar_fill.style.transform="scaleX("+t+")",this.video.muted&&this.toggleMute(),t>=.5?(this.button_volume.classList.add("volume-2"),this.button_volume.classList.remove("volume-1"),this.button_volume.classList.remove("volume-0")):t<.5&&t>=.25?(this.button_volume.classList.remove("volume-2"),this.button_volume.classList.add("volume-1"),this.button_volume.classList.remove("volume-0")):t<.25?(this.button_volume.classList.remove("volume-2"),this.button_volume.classList.remove("volume-1"),this.button_volume.classList.add("volume-0")):t<=0&&(this.button_volume.classList.remove("volume-2"),this.button_volume.classList.remove("volume-1"),this.button_volume.classList.remove("volume-0"),this.toggleMute())}},{key:"toggleMute",value:function(){this.video.muted?(this.video.muted=!1,this.button_volume.classList.remove("mute"),this.volume_seek_bar_fill.style.transform="scaleX("+this.video.volume+")"):(this.video.muted=!0,this.button_volume.classList.add("mute"),this.volume_seek_bar_fill.style.transform="scaleX(0)")}},{key:"toggleFullscreen",value:function(){null==document.fullscreenElement&&null==document.mozFullscreenElement&&null==document.webkitFullscreenElement&&null==document.msFullscreenElement?this.container.requestFullscreen?this.container.requestFullscreen():this.container.mozRequestFullScreen?this.container.mozRequestFullScreen():this.container.webkitRequestFullscreen?this.container.webkitRequestFullscreen():this.container.msRequestFullscreen&&this.container.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}},{key:"render",value:function(){this.video.paused||window.requestAnimationFrame(this.render.bind(this));var e=this.video.currentTime/this.video.duration;this.time_seek_bar_fill.style.transform="scaleX("+e+")",this.time_current.textContent=this.formatTime(this.video.currentTime),this.video.currentTime==this.video.duration&&this.container.classList.remove("playing")}},{key:"formatTime",value:function(e){e=Math.round(e);var t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),s=e-3600*t-60*i;return t=t<10?"0"+t:t,i=i<10?"0"+i:i,s=s<10?"0"+s:s,0!=t?t+":"+i+":"+s:i+":"+s}}]),e}(),controller=new Controller(document.querySelector(".section-videos-wrapper"));controller.init(),console.log(controller);var burger_button=document.querySelector(".header-burger"),burger_nav=document.querySelector(".header-nav");burger_button.addEventListener("click",function(){burger_button.classList.toggle("header-burger-active"),burger_nav.classList.toggle("header-nav-expand")});for(var exhibitions_buttons_item=document.querySelectorAll(".section-exhibitions-container-slider-nav-list--item"),exhibitions_buttons_container=document.querySelector(".section-exhibitions-container-slider-nav-list"),exhibitions_list_img=document.querySelector(".section-exhibitions-container-slider-wrapper-list"),exhibitions_list_content=document.querySelector(".section-exhibitions-container-content-wrapper-list"),exhibitions_last_index=0,i=0;i<exhibitions_buttons_item.length;i++)exhibitions_buttons_item[i].addEventListener("click",function(){var e=Array.prototype.indexOf.call(exhibitions_buttons_item,this);void 0!=exhibitions_buttons_item[exhibitions_last_index]&&exhibitions_buttons_item[exhibitions_last_index].classList.remove("active"),exhibitions_last_index=e,exhibitions_buttons_item[e].classList.add("active"),window.innerWidth>=900?(exhibitions_list_img.style.transform="translateX(-"+100*e+"%)",exhibitions_list_content.style.transform="translateX(-"+100*e+"%)"):(exhibitions_list_img.style.transform="translateX(-"+100*e+"%)",exhibitions_list_content.style.transform="translateX(-"+100*e+"%)",exhibitions_buttons_container.style.transform="translateX(-"+(e-1)/3*100+"%)")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkNvbnRyb2xsZXIuanMiLCJtYWluLmpzIl0sIm5hbWVzIjpbIkNvbnRyb2xsZXIiLCJjb250YWluZXIiLCJfdGhpcyIsInRoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJidXR0b25fdG9nZ2xlIiwicXVlcnlTZWxlY3RvciIsInZpZGVvIiwidGltZV9zZWVrX2JhciIsInRpbWVfc2Vla19iYXJfZmlsbCIsInRpbWVfZHJhZyIsInRpbWVfY3VycmVudCIsInRpbWVfZHVyYXRpb24iLCJidXR0b25fdm9sdW1lIiwidm9sdW1lX3NlZWtfYmFyIiwidm9sdW1lX3NlZWtfYmFyX2ZpbGwiLCJ2b2x1bWVfZHJhZyIsImVmZmVjdF9wYXVzZSIsImVmZmVjdF9wbGF5IiwiYnV0dG9uX2Z1bGxzY3JlZW4iLCJhZGRFdmVudExpc3RlbmVyIiwidG9nZ2xlU3RhdGUiLCJlIiwidGltZV9wb3NpdGlvbnMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ1cGRhdGVUaW1lIiwid2luZG93IiwidXBkYXRlVm9sdW1lIiwidG9nZ2xlTXV0ZSIsInZvbHVtZV9wb3NpdGlvbnMiLCJ0b2dnbGVGdWxsc2NyZWVuIiwicGF1c2VkIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiX3RoaXMyIiwicGF1c2UiLCJjdXJyZW50VGltZSIsInRleHRDb250ZW50IiwiZm9ybWF0VGltZSIsImR1cmF0aW9uIiwic3R5bGUiLCJ0cmFuc2Zvcm0iLCJwbGF5IiwicmVuZGVyIiwicmF0aW8iLCJwYWdlWCIsImxlZnQiLCJ3aWR0aCIsInZvbHVtZSIsIm11dGVkIiwiZG9jdW1lbnQiLCJmdWxsc2NyZWVuRWxlbWVudCIsIm1vekZ1bGxzY3JlZW5FbGVtZW50Iiwid2Via2l0RnVsbHNjcmVlbkVsZW1lbnQiLCJtc0Z1bGxzY3JlZW5FbGVtZW50IiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJtb3pSZXF1ZXN0RnVsbFNjcmVlbiIsIndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuIiwibXNSZXF1ZXN0RnVsbHNjcmVlbiIsImV4aXRGdWxsc2NyZWVuIiwibW96RXhpdEZ1bGxTY3JlZW4iLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJiaW5kIiwidGltZSIsIk1hdGgiLCJyb3VuZCIsImhvdXJzIiwiZmxvb3IiLCJtaW51dGVzIiwic2Vjb25kcyIsImNvbnRyb2xsZXIiLCJpbml0IiwiY29uc29sZSIsImxvZyIsImJ1cmdlcl9idXR0b24iLCJidXJnZXJfbmF2IiwidG9nZ2xlIiwiZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtIiwicXVlcnlTZWxlY3RvckFsbCIsImV4aGliaXRpb25zX2J1dHRvbnNfY29udGFpbmVyIiwiZXhoaWJpdGlvbnNfbGlzdF9pbWciLCJleGhpYml0aW9uc19saXN0X2NvbnRlbnQiLCJleGhpYml0aW9uc19sYXN0X2luZGV4IiwiaSIsImxlbmd0aCIsImluZGV4IiwiQXJyYXkiLCJwcm90b3R5cGUiLCJpbmRleE9mIiwiY2FsbCIsInVuZGVmaW5lZCIsImlubmVyV2lkdGgiXSwibWFwcGluZ3MiOiI2WEFBTUEsV0FBQUEsV0FDSixTQUFBQSxFQUFZQyxHQUFVLElBQUFDLEVBQUFDLEtBQUFDLGdCQUFBRCxLQUFBSCxHQUNwQkcsS0FBS0YsVUFBZ0JBLEVBQ3JCRSxLQUFLRSxjQUFnQkYsS0FBS0YsVUFBVUssY0FBYyw0Q0FDbERILEtBQUtJLE1BQWdCSixLQUFLRixVQUFVSyxjQUFjLGlDQUVsREgsS0FBS0ssY0FBcUJMLEtBQUtGLFVBQVVLLGNBQWMsNkNBQ3ZESCxLQUFLTSxtQkFBcUJOLEtBQUtLLGNBQWNGLGNBQWMsbURBQzNESCxLQUFLTyxXQUFZLEVBRWpCUCxLQUFLUSxhQUFnQlIsS0FBS0YsVUFBVUssY0FBYyxrREFDbERILEtBQUtTLGNBQWdCVCxLQUFLRixVQUFVSyxjQUFjLG1EQUVsREgsS0FBS1UsY0FBZ0JWLEtBQUtGLFVBQVVLLGNBQWMsaURBQ2xESCxLQUFLVyxnQkFBdUJYLEtBQUtGLFVBQVVLLGNBQWMsZ0RBQ3pESCxLQUFLWSxxQkFBdUJaLEtBQUtGLFVBQVVLLGNBQWMscURBQ3pESCxLQUFLYSxhQUFjLEVBRW5CYixLQUFLYyxhQUFlZCxLQUFLRixVQUFVSyxjQUFjLHdDQUNqREgsS0FBS2UsWUFBZWYsS0FBS0YsVUFBVUssY0FBYyx1Q0FFakRILEtBQUtnQixrQkFBb0JoQixLQUFLRixVQUFVSyxjQUFjLGdEQUV0REgsS0FBS0UsY0FBY2UsaUJBQWlCLFFBQVMsV0FDM0NsQixFQUFLbUIsZ0JBR1BsQixLQUFLSyxjQUFjWSxpQkFBaUIsUUFBUyxTQUFDRSxHQUM1Q3BCLEVBQUtxQixlQUFpQnJCLEVBQUtNLGNBQWNnQix3QkFFekN0QixFQUFLdUIsV0FBV0gsS0FHbEJuQixLQUFLSyxjQUFjWSxpQkFBaUIsWUFBYSxXQUMzQ2xCLEVBQUtRLFlBQ1BSLEVBQUtxQixlQUFpQnJCLEVBQUtNLGNBQWNnQix3QkFDekN0QixFQUFLUSxXQUFZLEtBSXJCZ0IsT0FBT04saUJBQWlCLFVBQVcsV0FDOUJsQixFQUFLUSxZQUNOUixFQUFLUSxXQUFZLEdBR2hCUixFQUFLYyxjQUNOZCxFQUFLYyxhQUFjLEtBSXZCVSxPQUFPTixpQkFBaUIsWUFBYSxTQUFDRSxHQUNqQ3BCLEVBQUtRLFdBQ05SLEVBQUt1QixXQUFXSCxHQUVmcEIsRUFBS2MsYUFDTmQsRUFBS3lCLGFBQWFMLEtBSXRCbkIsS0FBS1UsY0FBY08saUJBQWlCLFFBQVMsV0FDM0NsQixFQUFLMEIsZUFHUHpCLEtBQUtXLGdCQUFnQk0saUJBQWlCLFFBQVMsU0FBQ0UsR0FDOUNwQixFQUFLMkIsaUJBQW1CM0IsRUFBS1ksZ0JBQWdCVSx3QkFDN0N0QixFQUFLeUIsYUFBYUwsS0FHcEJuQixLQUFLVyxnQkFBZ0JNLGlCQUFpQixZQUFhLFdBQzdDbEIsRUFBS2MsY0FDUGQsRUFBSzJCLGlCQUFtQjNCLEVBQUtZLGdCQUFnQlUsd0JBQzdDdEIsRUFBS2MsYUFBYyxLQUl2QmIsS0FBS2dCLGtCQUFrQkMsaUJBQWlCLFFBQVMsV0FDL0NsQixFQUFLNEIscUJBR1AzQixLQUFLSSxNQUFNYSxpQkFBaUIsV0FBWSxXQUN0Q2xCLEVBQUs0QixxQkFHUDNCLEtBQUtJLE1BQU1hLGlCQUFpQixRQUFTLFdBQ25DbEIsRUFBS21CLGNBQ0ZuQixFQUFLSyxNQUFNd0IsUUFDWjdCLEVBQUtnQixZQUFZYyxVQUFVQyxJQUFJLFVBQy9CL0IsRUFBS2UsYUFBYWUsVUFBVUUsT0FBTyxZQUduQ2hDLEVBQUtlLGFBQWFlLFVBQVVDLElBQUksVUFDaEMvQixFQUFLZ0IsWUFBWWMsVUFBVUUsT0FBTyxpRUFNbEMsSUFBQUMsRUFBQWhDLEtBQ0pBLEtBQUtJLE1BQU1hLGlCQUFpQixhQUFjLFdBQ3hDZSxFQUFLNUIsTUFBTTZCLFFBQ1hELEVBQUs1QixNQUFNOEIsWUFBYyxFQUN6QkYsRUFBS3ZCLGNBQWMwQixZQUFjSCxFQUFLSSxXQUFXSixFQUFLNUIsTUFBTWlDLFVBQzVETCxFQUFLeEIsYUFBYTJCLFlBQWNILEVBQUtJLFdBQVdKLEVBQUs1QixNQUFNOEIsYUFFM0RGLEVBQUsxQixtQkFBbUJnQyxNQUFNQyxVQUFZLG9EQU96Q3ZDLEtBQUtJLE1BQU13QixRQUNaNUIsS0FBS0ksTUFBTW9DLE9BQ1h4QyxLQUFLRixVQUFVK0IsVUFBVUMsSUFBSSxXQUM3QjlCLEtBQUt5QyxXQUdMekMsS0FBS0ksTUFBTTZCLFFBQ1hqQyxLQUFLRixVQUFVK0IsVUFBVUUsT0FBTyxZQUVsQy9CLEtBQUtjLGFBQWFlLFVBQVVFLE9BQU8sVUFDbkMvQixLQUFLZSxZQUFZYyxVQUFVRSxPQUFPLDZDQUd6QlosR0FDVCxJQUFJdUIsR0FBU3ZCLEVBQUV3QixNQUFRM0MsS0FBS29CLGVBQWV3QixNQUFRNUMsS0FBS29CLGVBQWV5QixNQUN2RTdDLEtBQUtNLG1CQUFtQmdDLE1BQU1DLFVBQVksVUFBV0csRUFBTyxJQUM1RDFDLEtBQUtJLE1BQU04QixZQUFjUSxFQUFRMUMsS0FBS0ksTUFBTWlDLFNBQzVDckMsS0FBS1EsYUFBYTJCLFlBQWNuQyxLQUFLb0MsV0FBV3BDLEtBQUtJLE1BQU04QixrREFHaERmLEdBQ1gsSUFBSXVCLEdBQVN2QixFQUFFd0IsTUFBUTNDLEtBQUswQixpQkFBaUJrQixNQUFRNUMsS0FBSzBCLGlCQUFpQm1CLE1BQzNFN0MsS0FBS0ksTUFBTTBDLE9BQVNKLEVBQ3BCMUMsS0FBS1kscUJBQXFCMEIsTUFBTUMsVUFBWSxVQUFXRyxFQUFPLElBQzNEMUMsS0FBS0ksTUFBTTJDLE9BQ1ovQyxLQUFLeUIsYUFHSmlCLEdBQVMsSUFDVjFDLEtBQUtVLGNBQWNtQixVQUFVQyxJQUFJLFlBQ2pDOUIsS0FBS1UsY0FBY21CLFVBQVVFLE9BQU8sWUFDcEMvQixLQUFLVSxjQUFjbUIsVUFBVUUsT0FBTyxhQUU5QlcsRUFBUSxJQUFNQSxHQUFTLEtBQzdCMUMsS0FBS1UsY0FBY21CLFVBQVVFLE9BQU8sWUFDcEMvQixLQUFLVSxjQUFjbUIsVUFBVUMsSUFBSSxZQUNqQzlCLEtBQUtVLGNBQWNtQixVQUFVRSxPQUFPLGFBRTlCVyxFQUFRLEtBQ2QxQyxLQUFLVSxjQUFjbUIsVUFBVUUsT0FBTyxZQUNwQy9CLEtBQUtVLGNBQWNtQixVQUFVRSxPQUFPLFlBQ3BDL0IsS0FBS1UsY0FBY21CLFVBQVVDLElBQUksYUFFM0JZLEdBQVMsSUFDZjFDLEtBQUtVLGNBQWNtQixVQUFVRSxPQUFPLFlBQ3BDL0IsS0FBS1UsY0FBY21CLFVBQVVFLE9BQU8sWUFDcEMvQixLQUFLVSxjQUFjbUIsVUFBVUUsT0FBTyxZQUNwQy9CLEtBQUt5QixtREFLSnpCLEtBQUtJLE1BQU0yQyxPQUNaL0MsS0FBS0ksTUFBTTJDLE9BQVEsRUFDbkIvQyxLQUFLVSxjQUFjbUIsVUFBVUUsT0FBTyxRQUNwQy9CLEtBQUtZLHFCQUFxQjBCLE1BQU1DLFVBQVksVUFBV3ZDLEtBQUtJLE1BQU0wQyxPQUFRLE1BRzFFOUMsS0FBS0ksTUFBTTJDLE9BQVEsRUFDbkIvQyxLQUFLVSxjQUFjbUIsVUFBVUMsSUFBSSxRQUNqQzlCLEtBQUtZLHFCQUFxQjBCLE1BQU1DLFVBQVksd0RBS2IsTUFBOUJTLFNBQVNDLG1CQUE4RCxNQUFqQ0QsU0FBU0Usc0JBQW9FLE1BQXBDRixTQUFTRyx5QkFBa0UsTUFBL0JILFNBQVNJLG9CQUNsSXBELEtBQUtGLFVBQVV1RCxrQkFDaEJyRCxLQUFLRixVQUFVdUQsb0JBRVRyRCxLQUFLRixVQUFVd0QscUJBQ3JCdEQsS0FBS0YsVUFBVXdELHVCQUVUdEQsS0FBS0YsVUFBVXlELHdCQUNyQnZELEtBQUtGLFVBQVV5RCwwQkFFVHZELEtBQUtGLFVBQVUwRCxxQkFDckJ4RCxLQUFLRixVQUFVMEQsc0JBSWRSLFNBQVNTLGVBQ1ZULFNBQVNTLGlCQUVIVCxTQUFTVSxrQkFDZlYsU0FBU1Usb0JBRUhWLFNBQVNXLHFCQUNmWCxTQUFTVyx1QkFFSFgsU0FBU1ksa0JBQ2ZaLFNBQVNZLG9EQVFUNUQsS0FBS0ksTUFBTXdCLFFBQ2JMLE9BQU9zQyxzQkFBc0I3RCxLQUFLeUMsT0FBT3FCLEtBQUs5RCxPQUdoRCxJQUFJMEMsRUFBUTFDLEtBQUtJLE1BQU04QixZQUFjbEMsS0FBS0ksTUFBTWlDLFNBQ2hEckMsS0FBS00sbUJBQW1CZ0MsTUFBTUMsVUFBWSxVQUFXRyxFQUFPLElBRTVEMUMsS0FBS1EsYUFBYTJCLFlBQWNuQyxLQUFLb0MsV0FBV3BDLEtBQUtJLE1BQU04QixhQUV4RGxDLEtBQUtJLE1BQU04QixhQUFlbEMsS0FBS0ksTUFBTWlDLFVBQ3RDckMsS0FBS0YsVUFBVStCLFVBQVVFLE9BQU8sOENBTXpCZ0MsR0FDVEEsRUFBUUMsS0FBS0MsTUFBTUYsR0FDbkIsSUFBSUcsRUFBVUYsS0FBS0csTUFBTUosRUFBTyxNQUM1QkssRUFBVUosS0FBS0csT0FBT0osRUFBZ0IsS0FBUkcsR0FBaUIsSUFDL0NHLEVBQVVOLEVBQWdCLEtBQVJHLEVBQTJCLEdBQVZFLEVBTXZDLE9BSkFGLEVBQVVBLEVBQVUsR0FBSyxJQUFJQSxFQUFRQSxFQUNyQ0UsRUFBVUEsRUFBVSxHQUFLLElBQUlBLEVBQVVBLEVBQ3ZDQyxFQUFVQSxFQUFVLEdBQUssSUFBSUEsRUFBVUEsRUFFM0IsR0FBVEgsRUFDTUEsRUFBTSxJQUFJRSxFQUFRLElBQUlDLEVBR3RCRCxFQUFRLElBQUlDLFFBL09uQnhFLEdBb1BBeUUsV0FBYSxJQUFJekUsV0FBV21ELFNBQVM3QyxjQUFjLDRCQUN6RG1FLFdBQVdDLE9BQ1hDLFFBQVFDLElBQUlILFlDdFBaLElBQU1JLGNBQWdCMUIsU0FBUzdDLGNBQWMsa0JBQ3ZDd0UsV0FBZ0IzQixTQUFTN0MsY0FBYyxlQUU3Q3VFLGNBQWN6RCxpQkFBaUIsUUFBUyxXQUN0Q3lELGNBQWM3QyxVQUFVK0MsT0FBTyx3QkFDL0JELFdBQVc5QyxVQUFVK0MsT0FBTyx1QkFXOUIsSUFBSyxJQU5DQyx5QkFBMkI3QixTQUFTOEIsaUJBQWlCLHdEQUNyREMsOEJBQWdDL0IsU0FBUzdDLGNBQWMsa0RBQ3ZENkUscUJBQTJCaEMsU0FBUzdDLGNBQWMsc0RBQ2xEOEUseUJBQTJCakMsU0FBUzdDLGNBQWMsdURBQ3BEK0UsdUJBQXlCLEVBRXBCQyxFQUFJLEVBQUdBLEVBQUlOLHlCQUF5Qk8sT0FBUUQsSUFDbkROLHlCQUF5Qk0sR0FBR2xFLGlCQUFpQixRQUFTLFdBQ3BELElBQUlvRSxFQUFRQyxNQUFNQyxVQUFVQyxRQUFRQyxLQUFLWix5QkFBMEI3RSxXQUVaMEYsR0FBcERiLHlCQUF5QksseUJBQzFCTCx5QkFBeUJLLHdCQUF3QnJELFVBQVVFLE9BQU8sVUFFcEVtRCx1QkFBeUJHLEVBRXpCUix5QkFBeUJRLEdBQU94RCxVQUFVQyxJQUFJLFVBRzNDUCxPQUFPb0UsWUFBYyxLQUN0QlgscUJBQXFCMUMsTUFBTUMsVUFBWSxlQUF5QixJQUFSOEMsRUFBYyxLQUN0RUoseUJBQXlCM0MsTUFBTUMsVUFBWSxlQUF5QixJQUFSOEMsRUFBYyxPQUcxRUwscUJBQXFCMUMsTUFBTUMsVUFBWSxlQUF5QixJQUFSOEMsRUFBYyxLQUN0RUoseUJBQXlCM0MsTUFBTUMsVUFBWSxlQUF5QixJQUFSOEMsRUFBYyxLQUMxRU4sOEJBQThCekMsTUFBTUMsVUFBWSxnQkFBbUI4QyxFQUFNLEdBQUcsRUFBSyxJQUFNIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQ29udHJvbGxlcntcbiAgY29uc3RydWN0b3IoY29udGFpbmVyKXtcbiAgICB0aGlzLmNvbnRhaW5lciAgICAgPSBjb250YWluZXJcbiAgICB0aGlzLmJ1dHRvbl90b2dnbGUgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy0tdG9nZ2xlJylcbiAgICB0aGlzLnZpZGVvICAgICAgICAgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci12aWRlbycpXG4gICAgXG4gICAgdGhpcy50aW1lX3NlZWtfYmFyICAgICAgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy1zZWVrLWJhcicpXG4gICAgdGhpcy50aW1lX3NlZWtfYmFyX2ZpbGwgPSB0aGlzLnRpbWVfc2Vla19iYXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtc2Vlay1iYXItLWZpbGwnKVxuICAgIHRoaXMudGltZV9kcmFnID0gZmFsc2VcblxuICAgIHRoaXMudGltZV9jdXJyZW50ICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLS10aW1lLWN1cnJlbnQnKVxuICAgIHRoaXMudGltZV9kdXJhdGlvbiA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLS10aW1lLWR1cmF0aW9uJylcbiAgICBcbiAgICB0aGlzLmJ1dHRvbl92b2x1bWUgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy12b2x1bWUtLWljb24nKVxuICAgIHRoaXMudm9sdW1lX3NlZWtfYmFyICAgICAgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy12b2x1bWUtLWJhcicpXG4gICAgdGhpcy52b2x1bWVfc2Vla19iYXJfZmlsbCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLXZvbHVtZS0tYmFyLWZpbGwnKVxuICAgIHRoaXMudm9sdW1lX2RyYWcgPSBmYWxzZVxuXG4gICAgdGhpcy5lZmZlY3RfcGF1c2UgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1lZmZlY3QtcGF1c2UnKVxuICAgIHRoaXMuZWZmZWN0X3BsYXkgID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItZWZmZWN0LXBsYXknKVxuICAgIFxuICAgIHRoaXMuYnV0dG9uX2Z1bGxzY3JlZW4gPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy0tZnVsbHNjcmVlbicpXG5cbiAgICB0aGlzLmJ1dHRvbl90b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xuICAgICAgdGhpcy50b2dnbGVTdGF0ZSgpXG4gICAgfSlcblxuICAgIHRoaXMudGltZV9zZWVrX2Jhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKT0+e1xuICAgICAgdGhpcy50aW1lX3Bvc2l0aW9ucyA9IHRoaXMudGltZV9zZWVrX2Jhci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgXG4gICAgICB0aGlzLnVwZGF0ZVRpbWUoZSlcbiAgICB9KVxuXG4gICAgdGhpcy50aW1lX3NlZWtfYmFyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsICgpPT57XG4gICAgICBpZighdGhpcy50aW1lX2RyYWcpe1xuICAgICAgICB0aGlzLnRpbWVfcG9zaXRpb25zID0gdGhpcy50aW1lX3NlZWtfYmFyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpICAgICAgXG4gICAgICAgIHRoaXMudGltZV9kcmFnID0gdHJ1ZVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsICgpPT57XG4gICAgICBpZih0aGlzLnRpbWVfZHJhZyl7XG4gICAgICAgIHRoaXMudGltZV9kcmFnID0gZmFsc2VcbiAgICAgIH1cblxuICAgICAgaWYodGhpcy52b2x1bWVfZHJhZyl7XG4gICAgICAgIHRoaXMudm9sdW1lX2RyYWcgPSBmYWxzZVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgKGUpPT57XG4gICAgICBpZih0aGlzLnRpbWVfZHJhZyl7XG4gICAgICAgIHRoaXMudXBkYXRlVGltZShlKVxuICAgICAgfVxuICAgICAgaWYodGhpcy52b2x1bWVfZHJhZyl7XG4gICAgICAgIHRoaXMudXBkYXRlVm9sdW1lKGUpICAgICAgICBcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5idXR0b25fdm9sdW1lLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT57XG4gICAgICB0aGlzLnRvZ2dsZU11dGUoKVxuICAgIH0pXG5cbiAgICB0aGlzLnZvbHVtZV9zZWVrX2Jhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PntcbiAgICAgIHRoaXMudm9sdW1lX3Bvc2l0aW9ucyA9IHRoaXMudm9sdW1lX3NlZWtfYmFyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgICB0aGlzLnVwZGF0ZVZvbHVtZShlKVxuICAgIH0pXG5cbiAgICB0aGlzLnZvbHVtZV9zZWVrX2Jhci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoKT0+e1xuICAgICAgaWYoIXRoaXMudm9sdW1lX2RyYWcpe1xuICAgICAgICB0aGlzLnZvbHVtZV9wb3NpdGlvbnMgPSB0aGlzLnZvbHVtZV9zZWVrX2Jhci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSAgICAgIFxuICAgICAgICB0aGlzLnZvbHVtZV9kcmFnID0gdHJ1ZVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLmJ1dHRvbl9mdWxsc2NyZWVuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PntcbiAgICAgIHRoaXMudG9nZ2xlRnVsbHNjcmVlbigpXG4gICAgfSlcblxuICAgIHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCAoKT0+e1xuICAgICAgdGhpcy50b2dnbGVGdWxsc2NyZWVuKCkgICAgICBcbiAgICB9KVxuXG4gICAgdGhpcy52aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgICB0aGlzLnRvZ2dsZVN0YXRlKClcbiAgICAgIGlmKHRoaXMudmlkZW8ucGF1c2VkKXtcbiAgICAgICAgdGhpcy5lZmZlY3RfcGxheS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuICAgICAgICB0aGlzLmVmZmVjdF9wYXVzZS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgICAgfVxuICAgICAgZWxzZXtcbiAgICAgICAgdGhpcy5lZmZlY3RfcGF1c2UuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcbiAgICAgICAgdGhpcy5lZmZlY3RfcGxheS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSAgICAgICAgXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIC8vIGluaXQgbmV3IHZpZGVvXG4gIGluaXQoKXtcbiAgICB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZGRhdGEnLCAoKSA9PntcbiAgICAgIHRoaXMudmlkZW8ucGF1c2UoKVxuICAgICAgdGhpcy52aWRlby5jdXJyZW50VGltZSA9IDBcbiAgICAgIHRoaXMudGltZV9kdXJhdGlvbi50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmR1cmF0aW9uKSAgIFxuICAgICAgdGhpcy50aW1lX2N1cnJlbnQudGV4dENvbnRlbnQgPSB0aGlzLmZvcm1hdFRpbWUodGhpcy52aWRlby5jdXJyZW50VGltZSkgICAgICAgXG4gICAgICBcbiAgICAgIHRoaXMudGltZV9zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoMCknICAgIFxuICAgIH0pICAgIFxuICB9XG5cblxuICAvL3VwZGF0ZSBmdW5jXG4gIHRvZ2dsZVN0YXRlKCl7XG4gICAgaWYodGhpcy52aWRlby5wYXVzZWQpe1xuICAgICAgdGhpcy52aWRlby5wbGF5KClcbiAgICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3BsYXlpbmcnKVxuICAgICAgdGhpcy5yZW5kZXIoKVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgdGhpcy52aWRlby5wYXVzZSgpXG4gICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5aW5nJylcbiAgICB9XG4gICAgdGhpcy5lZmZlY3RfcGF1c2UuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICB0aGlzLmVmZmVjdF9wbGF5LmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gIH1cblxuICB1cGRhdGVUaW1lKGUpe1xuICAgIGxldCByYXRpbyA9IChlLnBhZ2VYIC0gdGhpcy50aW1lX3Bvc2l0aW9ucy5sZWZ0KSAvIHRoaXMudGltZV9wb3NpdGlvbnMud2lkdGhcbiAgICB0aGlzLnRpbWVfc2Vla19iYXJfZmlsbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGVYKCcrIHJhdGlvICsnKSdcbiAgICB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lID0gcmF0aW8gKiB0aGlzLnZpZGVvLmR1cmF0aW9uXG4gICAgdGhpcy50aW1lX2N1cnJlbnQudGV4dENvbnRlbnQgPSB0aGlzLmZvcm1hdFRpbWUodGhpcy52aWRlby5jdXJyZW50VGltZSlcbiAgfVxuXG4gIHVwZGF0ZVZvbHVtZShlKXtcbiAgICBsZXQgcmF0aW8gPSAoZS5wYWdlWCAtIHRoaXMudm9sdW1lX3Bvc2l0aW9ucy5sZWZ0KSAvIHRoaXMudm9sdW1lX3Bvc2l0aW9ucy53aWR0aFxuICAgIHRoaXMudmlkZW8udm9sdW1lID0gcmF0aW9cbiAgICB0aGlzLnZvbHVtZV9zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoJysgcmF0aW8gKycpJyAgICBcbiAgICBpZih0aGlzLnZpZGVvLm11dGVkKXtcbiAgICAgIHRoaXMudG9nZ2xlTXV0ZSgpXG4gICAgfVxuXG4gICAgaWYocmF0aW8gPj0gLjUpe1xuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5hZGQoJ3ZvbHVtZS0yJylcbiAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMScpXG4gICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTAnKVxuICAgIH1cbiAgICBlbHNlIGlmKHJhdGlvIDwgLjUgJiYgcmF0aW8gPj0gLjI1KXtcbiAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMicpXG4gICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LmFkZCgndm9sdW1lLTEnKVxuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ3ZvbHVtZS0wJylcbiAgICB9XG4gICAgZWxzZSBpZihyYXRpbyA8IC4yNSl7XG4gICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTInKVxuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ3ZvbHVtZS0xJylcbiAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QuYWRkKCd2b2x1bWUtMCcpXG4gICAgfVxuICAgIGVsc2UgaWYocmF0aW8gPD0gMCl7XG4gICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTInKVxuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ3ZvbHVtZS0xJylcbiAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMCcpXG4gICAgICB0aGlzLnRvZ2dsZU11dGUoKVxuICAgIH1cbiAgfVxuXG4gIHRvZ2dsZU11dGUoKXtcbiAgICBpZih0aGlzLnZpZGVvLm11dGVkKXtcbiAgICAgIHRoaXMudmlkZW8ubXV0ZWQgPSBmYWxzZVxuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ211dGUnKVxuICAgICAgdGhpcy52b2x1bWVfc2Vla19iYXJfZmlsbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGVYKCcrIHRoaXMudmlkZW8udm9sdW1lICsnKScgICAgICAgICAgXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnZpZGVvLm11dGVkID0gdHJ1ZVxuICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5hZGQoJ211dGUnKVxuICAgICAgdGhpcy52b2x1bWVfc2Vla19iYXJfZmlsbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGVYKDApJyAgICBcbiAgICB9XG4gIH1cblxuICB0b2dnbGVGdWxsc2NyZWVuKCl7XG4gICAgaWYoZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQgPT0gbnVsbCAmJsKgZG9jdW1lbnQubW96RnVsbHNjcmVlbkVsZW1lbnQgPT0gbnVsbCAmJsKgZG9jdW1lbnQud2Via2l0RnVsbHNjcmVlbkVsZW1lbnQgPT0gbnVsbCAmJiBkb2N1bWVudC5tc0Z1bGxzY3JlZW5FbGVtZW50PT0gbnVsbCApe1xuICAgICAgaWYodGhpcy5jb250YWluZXIucmVxdWVzdEZ1bGxzY3JlZW4pe1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5yZXF1ZXN0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKHRoaXMuY29udGFpbmVyLm1velJlcXVlc3RGdWxsU2NyZWVuKXtcbiAgICAgICAgdGhpcy5jb250YWluZXIubW96UmVxdWVzdEZ1bGxTY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZih0aGlzLmNvbnRhaW5lci53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbil7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYodGhpcy5jb250YWluZXIubXNSZXF1ZXN0RnVsbHNjcmVlbil7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLm1zUmVxdWVzdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgIH1cbiAgICBlbHNle1xuICAgICAgaWYoZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pe1xuICAgICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKGRvY3VtZW50Lm1vekV4aXRGdWxsU2NyZWVuKXtcbiAgICAgICAgZG9jdW1lbnQubW96RXhpdEZ1bGxTY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZihkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbil7XG4gICAgICAgIGRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYoZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbil7XG4gICAgICAgIGRvY3VtZW50Lm1zRXhpdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cbiAgLy9yZW5kZXIgZnVuY1xuICByZW5kZXIoKXtcbiAgICBpZighdGhpcy52aWRlby5wYXVzZWQpe1xuICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlci5iaW5kKHRoaXMpKVxuICAgIH1cblxuICAgIGxldCByYXRpbyA9IHRoaXMudmlkZW8uY3VycmVudFRpbWUgLyB0aGlzLnZpZGVvLmR1cmF0aW9uXG4gICAgdGhpcy50aW1lX3NlZWtfYmFyX2ZpbGwuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlWCgnKyByYXRpbyArJyknXG5cbiAgICB0aGlzLnRpbWVfY3VycmVudC50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmN1cnJlbnRUaW1lKVxuICAgIFxuICAgIGlmKHRoaXMudmlkZW8uY3VycmVudFRpbWUgPT0gdGhpcy52aWRlby5kdXJhdGlvbil7XG4gICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5aW5nJykgICAgICBcbiAgICB9XG4gIH1cblxuXG4gIC8vIHVzZWZ1bGwgZnVuY1xuICBmb3JtYXRUaW1lKHRpbWUpe1xuICAgIHRpbWUgID0gTWF0aC5yb3VuZCh0aW1lKVxuICAgIGxldCBob3VycyAgID0gTWF0aC5mbG9vcih0aW1lIC8gMzYwMCk7XG4gICAgbGV0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKCh0aW1lIC0gKGhvdXJzICogMzYwMCkpIC8gNjApO1xuICAgIGxldCBzZWNvbmRzID0gdGltZSAtIChob3VycyAqIDM2MDApIC0gKG1pbnV0ZXMgKiA2MCk7XG5cbiAgICBob3VycyAgID0gaG91cnMgICA8IDEwID8gXCIwXCIraG91cnMgOiBob3Vyc1xuICAgIG1pbnV0ZXMgPSBtaW51dGVzIDwgMTAgPyBcIjBcIittaW51dGVzIDogbWludXRlc1xuICAgIHNlY29uZHMgPSBzZWNvbmRzIDwgMTAgPyBcIjBcIitzZWNvbmRzIDogc2Vjb25kc1xuXG4gICAgaWYoaG91cnMgIT0gMCl7XG4gICAgICByZXR1cm4gaG91cnMrJzonK21pbnV0ZXMrJzonK3NlY29uZHNcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHJldHVybiBtaW51dGVzKyc6JytzZWNvbmRzXG4gICAgfVxuICB9XG59XG5cbmNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQ29udHJvbGxlcihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlcicpKVxuY29udHJvbGxlci5pbml0KClcbmNvbnNvbGUubG9nKGNvbnRyb2xsZXIpIiwiY29uc3QgYnVyZ2VyX2J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXItYnVyZ2VyJylcbmNvbnN0IGJ1cmdlcl9uYXYgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyLW5hdicpXG5cbmJ1cmdlcl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xuICBidXJnZXJfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1idXJnZXItYWN0aXZlJylcbiAgYnVyZ2VyX25hdi5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItbmF2LWV4cGFuZCcpXG59KVxuXG5cblxuY29uc3QgZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24tZXhoaWJpdGlvbnMtY29udGFpbmVyLXNsaWRlci1uYXYtbGlzdC0taXRlbScpXG5jb25zdCBleGhpYml0aW9uc19idXR0b25zX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLWV4aGliaXRpb25zLWNvbnRhaW5lci1zbGlkZXItbmF2LWxpc3QnKVxuY29uc3QgZXhoaWJpdGlvbnNfbGlzdF9pbWcgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tZXhoaWJpdGlvbnMtY29udGFpbmVyLXNsaWRlci13cmFwcGVyLWxpc3QnKVxuY29uc3QgZXhoaWJpdGlvbnNfbGlzdF9jb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tZXhoaWJpdGlvbnMtY29udGFpbmVyLWNvbnRlbnQtd3JhcHBlci1saXN0JylcbmxldCBleGhpYml0aW9uc19sYXN0X2luZGV4ID0gMFxuXG5mb3IgKHZhciBpID0gMDsgaSA8IGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbS5sZW5ndGg7IGkrKykge1xuICBleGhpYml0aW9uc19idXR0b25zX2l0ZW1baV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xuICAgIGxldCBpbmRleCA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtLCB0aGlzKVxuXG4gICAgaWYoZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtW2V4aGliaXRpb25zX2xhc3RfaW5kZXhdICE9IHVuZGVmaW5lZCl7XG4gICAgICBleGhpYml0aW9uc19idXR0b25zX2l0ZW1bZXhoaWJpdGlvbnNfbGFzdF9pbmRleF0uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICB9XG4gICAgZXhoaWJpdGlvbnNfbGFzdF9pbmRleCA9IGluZGV4XG5cbiAgICBleGhpYml0aW9uc19idXR0b25zX2l0ZW1baW5kZXhdLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG5cblxuICAgIGlmKHdpbmRvdy5pbm5lcldpZHRoID49IDkwMCl7XG4gICAgICBleGhpYml0aW9uc19saXN0X2ltZy5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKGluZGV4ICogMTAwKSArJyUpJ1xuICAgICAgZXhoaWJpdGlvbnNfbGlzdF9jb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAoaW5kZXggKiAxMDApICsnJSknXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBleGhpYml0aW9uc19saXN0X2ltZy5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKGluZGV4ICogMTAwKSArJyUpJ1xuICAgICAgZXhoaWJpdGlvbnNfbGlzdF9jb250ZW50LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAoaW5kZXggKiAxMDApICsnJSknXG4gICAgICBleGhpYml0aW9uc19idXR0b25zX2NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKCgoaW5kZXgtMSkvMykgKiAxMDApICsnJSknXG4gICAgfVxuICB9KVxufSJdfQ==
