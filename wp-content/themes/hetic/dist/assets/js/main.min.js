"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),Player=function(){function e(t){var i=this,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(_classCallCheck(this,e),this.container=t,this.button_toggle=this.container.querySelector(".section-videos-wrapper-controls--toggle"),this.video=this.container.querySelector(".section-videos-wrapper-video"),this.time_seek_bar=this.container.querySelector(".section-videos-wrapper-controls-seek-bar"),this.time_seek_bar_fill=this.time_seek_bar.querySelector(".section-videos-wrapper-controls-seek-bar--fill"),this.time_drag=!1,this.time_current=this.container.querySelector(".section-videos-wrapper-controls--time-current"),this.time_duration=this.container.querySelector(".section-videos-wrapper-controls--time-duration"),this.button_volume=this.container.querySelector(".section-videos-wrapper-controls-volume--icon"),this.volume_seek_bar=this.container.querySelector(".section-videos-wrapper-controls-volume--bar"),this.volume_seek_bar_fill=this.container.querySelector(".section-videos-wrapper-controls-volume--bar-fill"),this.volume_drag=!1,this.effect_pause=this.container.querySelector(".section-videos-wrapper-effect-pause"),this.effect_play=this.container.querySelector(".section-videos-wrapper-effect-play"),this.button_fullscreen=this.container.querySelector(".section-videos-wrapper-controls--fullscreen"),this.button_toggle.addEventListener("click",function(){i.toggleState()}),this.time_seek_bar.addEventListener("click",function(e){i.time_positions=i.time_seek_bar.getBoundingClientRect(),i.updateTime(e)}),this.time_seek_bar.addEventListener("mousedown",function(){i.time_drag||(i.time_positions=i.time_seek_bar.getBoundingClientRect(),i.time_drag=!0)}),window.addEventListener("mouseup",function(){i.time_drag&&(i.time_drag=!1),i.volume_drag&&(i.volume_drag=!1)}),window.addEventListener("mousemove",function(e){i.time_drag&&i.updateTime(e),i.volume_drag&&i.updateVolume(e)}),this.button_volume.addEventListener("click",function(){i.toggleMute()}),this.volume_seek_bar.addEventListener("click",function(e){i.volume_positions=i.volume_seek_bar.getBoundingClientRect(),i.updateVolume(e)}),this.volume_seek_bar.addEventListener("mousedown",function(){i.volume_drag||(i.volume_positions=i.volume_seek_bar.getBoundingClientRect(),i.volume_drag=!0)}),this.button_fullscreen.addEventListener("click",function(){i.toggleFullscreen()}),this.video.addEventListener("dblclick",function(){i.toggleFullscreen()}),this.video.addEventListener("click",function(){i.toggleState(),i.video.paused?(i.effect_play.classList.add("active"),i.effect_pause.classList.remove("active")):(i.effect_pause.classList.add("active"),i.effect_play.classList.remove("active"))}),this.playlist=s,this.playlist){this.container_playlist=document.querySelector(".section-videos-nav-wrapper-list"),this.playlist_items=document.querySelectorAll(".section-videos-nav-wrapper-list-item"),this.playlist_next=document.querySelector(".section-videos-nav-controls--next"),this.playlist_prev=document.querySelector(".section-videos-nav-controls--prev"),this.playlist_index=0,this.playlist_selected=this.playlist_items[this.playlist_index],this.playlist_item_width=this.playlist_items[0].getBoundingClientRect().width+20,this.video_index=0,this.video_prev=this.container.querySelector(".section-videos-wrapper-controls--skip-prev"),this.video_next=this.container.querySelector(".section-videos-wrapper-controls--skip-next"),this.playlist_next.addEventListener("click",function(){i.playlist_index<i.playlist_items.length-i.playlist_size&&(i.playlist_index++,i.updatePlaylist())}),this.playlist_prev.addEventListener("click",function(){i.playlist_index>0&&(i.playlist_index--,i.updatePlaylist())});for(var n=0;n<this.playlist_items.length;n++)!function(){var e=i;i.playlist_items[n].addEventListener("click",function(){this!=e.playlist_selected&&(e.video_index=Array.prototype.indexOf.call(e.playlist_items,this),e.selectVideo())})}();this.video_prev.addEventListener("click",function(){i.video_index>0?(i.video_index--,i.selectVideo()):(i.video_prev.classList.add("hide"),console.log("nop prev")),i.video_next.classList.remove("hide")}),this.video_next.addEventListener("click",function(){i.video_index<i.playlist_items.length-1?(i.video_index++,i.selectVideo()):(i.video_next.classList.add("hide"),console.log("nop next")),i.video_prev.classList.remove("hide")}),this.video.addEventListener("ended",function(){i.video_index<i.playlist_items.length-1&&(i.video_index++,i.selectVideo())}),this.initPlaylist()}window.addEventListener("resize",function(){i.playlist_item_width=i.playlist_items[0].getBoundingClientRect().width+20,i.playlist&&(console.log("resize"),i.initPlaylist())}),this.init()}return _createClass(e,[{key:"init",value:function(){var e=this;this.container.classList.remove("playing"),this.effect_pause.classList.remove("active"),this.effect_play.classList.remove("active"),this.video.addEventListener("loadeddata",function(){e.video.currentTime=.45,e.time_duration.textContent=e.formatTime(e.video.duration),e.time_current.textContent=e.formatTime(e.video.currentTime),e.time_seek_bar_fill.style.transform="scaleX(0)"})}},{key:"initPlaylist",value:function(){var e=window.innerWidth;this.playlist_size=e<425?1:e<650?2:e<900?3:e<1300?5:e<2500?6:9,this.playlist_index=0,this.updatePlaylist()}},{key:"toggleState",value:function(){this.video.paused?(this.video.play(),this.container.classList.add("playing"),this.render()):(this.video.pause(),this.container.classList.remove("playing")),this.effect_pause.classList.remove("active"),this.effect_play.classList.remove("active")}},{key:"updateTime",value:function(e){var t=(e.pageX-this.time_positions.left)/this.time_positions.width;t>=0&&t<1&&(this.time_seek_bar_fill.style.transform="scaleX("+t+")",this.video.currentTime=t*this.video.duration,this.time_current.textContent=this.formatTime(this.video.currentTime))}},{key:"updateVolume",value:function(e){var t=(e.pageX-this.volume_positions.left)/this.volume_positions.width;t>=0&&t<1&&(this.video.volume=t,this.volume_seek_bar_fill.style.transform="scaleX("+t+")",this.video.muted&&this.toggleMute(),t>=.5?(this.button_volume.classList.add("volume-2"),this.button_volume.classList.remove("volume-1"),this.button_volume.classList.remove("volume-0")):t<.5&&t>=.25?(this.button_volume.classList.remove("volume-2"),this.button_volume.classList.add("volume-1"),this.button_volume.classList.remove("volume-0")):t<.25?(this.button_volume.classList.remove("volume-2"),this.button_volume.classList.remove("volume-1"),this.button_volume.classList.add("volume-0")):t<=0&&(this.button_volume.classList.remove("volume-2"),this.button_volume.classList.remove("volume-1"),this.button_volume.classList.remove("volume-0"),this.toggleMute()))}},{key:"toggleMute",value:function(){this.video.muted?(this.video.muted=!1,this.button_volume.classList.remove("mute"),this.volume_seek_bar_fill.style.transform="scaleX("+this.video.volume+")"):(this.video.muted=!0,this.button_volume.classList.add("mute"),this.volume_seek_bar_fill.style.transform="scaleX(0)")}},{key:"toggleFullscreen",value:function(){null==document.fullscreenElement&&null==document.mozFullscreenElement&&null==document.webkitFullscreenElement&&null==document.msFullscreenElement?this.container.requestFullscreen?this.container.requestFullscreen():this.container.mozRequestFullScreen?this.container.mozRequestFullScreen():this.container.webkitRequestFullscreen?this.container.webkitRequestFullscreen():this.container.msRequestFullscreen&&this.container.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}},{key:"updatePlaylist",value:function(){this.container_playlist.style.transform="translateX(-"+this.playlist_index*this.playlist_item_width+"px)",0==this.playlist_index?this.playlist_prev.classList.add("hide"):this.playlist_prev.classList.remove("hide"),this.playlist_index>=this.playlist_items.length-this.playlist_size?this.playlist_next.classList.add("hide"):this.playlist_next.classList.remove("hide")}},{key:"selectVideo",value:function(){this.playlist_selected.classList.remove("active"),this.playlist_selected=this.playlist_items[this.video_index],this.playlist_selected.classList.add("active"),this.video.src=this.playlist_selected.dataset.target,this.init(),this.video_index>this.playlist_index+this.playlist_size-1?(this.playlist_index++,this.updatePlaylist()):this.video_index<this.playlist_index&&(this.playlist_index--,this.updatePlaylist()),0==this.video_index?this.video_prev.classList.add("hide"):this.video_prev.classList.remove("hide"),this.video_index>=this.playlist_items.length-1?this.video_next.classList.add("hide"):this.video_next.classList.remove("hide")}},{key:"render",value:function(){this.video.paused||window.requestAnimationFrame(this.render.bind(this));var e=this.video.currentTime/this.video.duration;this.time_seek_bar_fill.style.transform="scaleX("+e+")",this.time_current.textContent=this.formatTime(this.video.currentTime),this.video.currentTime==this.video.duration&&this.container.classList.remove("playing")}},{key:"formatTime",value:function(e){e=Math.round(e);var t=Math.floor(e/3600),i=Math.floor((e-3600*t)/60),s=e-3600*t-60*i;return t=t<10?"0"+t:t,i=i<10?"0"+i:i,s=s<10?"0"+s:s,0!=t?t+":"+i+":"+s:i+":"+s}}]),e}(),burger_button=document.querySelector(".header-burger"),burger_nav=document.querySelector(".header-nav");burger_button.addEventListener("click",function(){burger_button.classList.toggle("header-burger-active"),burger_nav.classList.toggle("header-nav-expand")});var header=document.querySelector(".header"),header_hide=!1;if(window.addEventListener("mousewheel",function(e){!header_hide&&e.deltaY<0?(header.classList.remove("hide"),header_hide=!0):header_hide&&e.deltaY>0&&document.body.scrollTop>80&&(header.classList.add("hide"),header_hide=!1)}),void 0!=document.querySelector(".section-exhibitions")){var i;!function(){var e=document.querySelectorAll(".section-exhibitions-container-slider-nav-list--item"),t=document.querySelector(".section-exhibitions-container-slider-nav-list"),s=document.querySelector(".section-exhibitions-container-slider-wrapper-list"),n=document.querySelector(".section-exhibitions-container-content-wrapper-list"),l=0;for(i=0;i<e.length;i++)e[i].addEventListener("click",function(){var i=Array.prototype.indexOf.call(e,this);void 0!=e[l]&&e[l].classList.remove("active"),l=i,e[i].classList.add("active"),window.innerWidth>=900?(s.style.transform="translateX(-"+100*i+"%)",n.style.transform="translateX(-"+100*i+"%)"):(s.style.transform="translateX(-"+100*i+"%)",n.style.transform="translateX(-"+100*i+"%)",t.style.transform="translateX(-"+(i-1)/3*100+"%)")})}()}if(void 0!=document.querySelector(".section-videos-wrapper"))var player=new Player(document.querySelector(".section-videos-wrapper"),!0);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlBsYXllci5qcyIsIm1haW4uanMiXSwibmFtZXMiOlsiUGxheWVyIiwiY29udGFpbmVyIiwiX3RoaXMiLCJ0aGlzIiwicGxheWxpc3QiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfY2xhc3NDYWxsQ2hlY2siLCJidXR0b25fdG9nZ2xlIiwicXVlcnlTZWxlY3RvciIsInZpZGVvIiwidGltZV9zZWVrX2JhciIsInRpbWVfc2Vla19iYXJfZmlsbCIsInRpbWVfZHJhZyIsInRpbWVfY3VycmVudCIsInRpbWVfZHVyYXRpb24iLCJidXR0b25fdm9sdW1lIiwidm9sdW1lX3NlZWtfYmFyIiwidm9sdW1lX3NlZWtfYmFyX2ZpbGwiLCJ2b2x1bWVfZHJhZyIsImVmZmVjdF9wYXVzZSIsImVmZmVjdF9wbGF5IiwiYnV0dG9uX2Z1bGxzY3JlZW4iLCJhZGRFdmVudExpc3RlbmVyIiwidG9nZ2xlU3RhdGUiLCJlIiwidGltZV9wb3NpdGlvbnMiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ1cGRhdGVUaW1lIiwid2luZG93IiwidXBkYXRlVm9sdW1lIiwidG9nZ2xlTXV0ZSIsInZvbHVtZV9wb3NpdGlvbnMiLCJ0b2dnbGVGdWxsc2NyZWVuIiwicGF1c2VkIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiY29udGFpbmVyX3BsYXlsaXN0IiwiZG9jdW1lbnQiLCJwbGF5bGlzdF9pdGVtcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwbGF5bGlzdF9uZXh0IiwicGxheWxpc3RfcHJldiIsInBsYXlsaXN0X2luZGV4IiwicGxheWxpc3Rfc2VsZWN0ZWQiLCJwbGF5bGlzdF9pdGVtX3dpZHRoIiwid2lkdGgiLCJ2aWRlb19pbmRleCIsInZpZGVvX3ByZXYiLCJ2aWRlb19uZXh0IiwicGxheWxpc3Rfc2l6ZSIsInVwZGF0ZVBsYXlsaXN0IiwiaSIsInNlbGYiLCJBcnJheSIsInByb3RvdHlwZSIsImluZGV4T2YiLCJjYWxsIiwic2VsZWN0VmlkZW8iLCJfbG9vcCIsImNvbnNvbGUiLCJsb2ciLCJpbml0UGxheWxpc3QiLCJpbml0IiwiX3RoaXMyIiwiY3VycmVudFRpbWUiLCJ0ZXh0Q29udGVudCIsImZvcm1hdFRpbWUiLCJkdXJhdGlvbiIsInN0eWxlIiwidHJhbnNmb3JtIiwiaW5uZXJXaWR0aCIsInBsYXkiLCJyZW5kZXIiLCJwYXVzZSIsInJhdGlvIiwicGFnZVgiLCJsZWZ0Iiwidm9sdW1lIiwibXV0ZWQiLCJmdWxsc2NyZWVuRWxlbWVudCIsIm1vekZ1bGxzY3JlZW5FbGVtZW50Iiwid2Via2l0RnVsbHNjcmVlbkVsZW1lbnQiLCJtc0Z1bGxzY3JlZW5FbGVtZW50IiwicmVxdWVzdEZ1bGxzY3JlZW4iLCJtb3pSZXF1ZXN0RnVsbFNjcmVlbiIsIndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuIiwibXNSZXF1ZXN0RnVsbHNjcmVlbiIsImV4aXRGdWxsc2NyZWVuIiwibW96RXhpdEZ1bGxTY3JlZW4iLCJ3ZWJraXRFeGl0RnVsbHNjcmVlbiIsIm1zRXhpdEZ1bGxzY3JlZW4iLCJzcmMiLCJkYXRhc2V0IiwidGFyZ2V0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYmluZCIsInRpbWUiLCJNYXRoIiwicm91bmQiLCJob3VycyIsImZsb29yIiwibWludXRlcyIsInNlY29uZHMiLCJidXJnZXJfYnV0dG9uIiwiYnVyZ2VyX25hdiIsInRvZ2dsZSIsImhlYWRlciIsImhlYWRlcl9oaWRlIiwiZGVsdGFZIiwiYm9keSIsInNjcm9sbFRvcCIsImV4aGliaXRpb25zX2J1dHRvbnNfaXRlbSIsImV4aGliaXRpb25zX2J1dHRvbnNfY29udGFpbmVyIiwiZXhoaWJpdGlvbnNfbGlzdF9pbWciLCJleGhpYml0aW9uc19saXN0X2NvbnRlbnQiLCJleGhpYml0aW9uc19sYXN0X2luZGV4IiwiaW5kZXgiLCJwbGF5ZXIiXSwibWFwcGluZ3MiOiI2WEFBTUEsT0FBQUEsV0FDSixTQUFBQSxFQUFZQyxHQUE0QixJQUFBQyxFQUFBQyxLQUFqQkMsRUFBaUJDLFVBQUFDLE9B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RCxFQUF5QjVELEdBQUc5QixpQkFBaUIsUUFBUyxXQUNwRCxJQUFJK0YsRUFBUS9ELE1BQU1DLFVBQVVDLFFBQVFDLEtBQUt1RCxFQUEwQi9HLFdBRVpJLEdBQXBEMkcsRUFBeUJJLElBQzFCSixFQUF5QkksR0FBd0JsRixVQUFVRSxPQUFPLFVBRXBFZ0YsRUFBeUJDLEVBRXpCTCxFQUF5QkssR0FBT25GLFVBQVVDLElBQUksVUFFM0NQLE9BQU8yQyxZQUFjLEtBQ3RCMkMsRUFBcUI3QyxNQUFNQyxVQUFZLGVBQXlCLElBQVIrQyxFQUFjLEtBQ3RFRixFQUF5QjlDLE1BQU1DLFVBQVksZUFBeUIsSUFBUitDLEVBQWMsT0FHMUVILEVBQXFCN0MsTUFBTUMsVUFBWSxlQUF5QixJQUFSK0MsRUFBYyxLQUN0RUYsRUFBeUI5QyxNQUFNQyxVQUFZLGVBQXlCLElBQVIrQyxFQUFjLEtBQzFFSixFQUE4QjVDLE1BQU1DLFVBQVksZ0JBQW1CK0MsRUFBTSxHQUFHLEVBQUssSUFBTSxRQXpCaEMsR0FpQy9ELFFBQXdEaEgsR0FBckRpQyxTQUFTOUIsY0FBYywyQkFDeEIsSUFBTThHLE9BQVMsSUFBSXhILE9BQU93QyxTQUFTOUIsY0FBYyw0QkFBNEIiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBQbGF5ZXJ7XG4gIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgcGxheWxpc3QgPSBmYWxzZSl7XG4gICAgdGhpcy5jb250YWluZXIgICAgID0gY29udGFpbmVyXG4gICAgdGhpcy5idXR0b25fdG9nZ2xlID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLXRvZ2dsZScpXG4gICAgdGhpcy52aWRlbyAgICAgICAgID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItdmlkZW8nKVxuICAgIFxuICAgIHRoaXMudGltZV9zZWVrX2JhciAgICAgID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtc2Vlay1iYXInKVxuICAgIHRoaXMudGltZV9zZWVrX2Jhcl9maWxsID0gdGhpcy50aW1lX3NlZWtfYmFyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLXNlZWstYmFyLS1maWxsJylcbiAgICB0aGlzLnRpbWVfZHJhZyAgICAgICAgICA9IGZhbHNlXG5cbiAgICB0aGlzLnRpbWVfY3VycmVudCAgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy0tdGltZS1jdXJyZW50JylcbiAgICB0aGlzLnRpbWVfZHVyYXRpb24gPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy0tdGltZS1kdXJhdGlvbicpXG4gICAgXG4gICAgdGhpcy5idXR0b25fdm9sdW1lID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtdm9sdW1lLS1pY29uJylcbiAgICB0aGlzLnZvbHVtZV9zZWVrX2JhciAgICAgID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtdm9sdW1lLS1iYXInKVxuICAgIHRoaXMudm9sdW1lX3NlZWtfYmFyX2ZpbGwgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3Mtd3JhcHBlci1jb250cm9scy12b2x1bWUtLWJhci1maWxsJylcbiAgICB0aGlzLnZvbHVtZV9kcmFnID0gZmFsc2VcblxuICAgIHRoaXMuZWZmZWN0X3BhdXNlID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItZWZmZWN0LXBhdXNlJylcbiAgICB0aGlzLmVmZmVjdF9wbGF5ICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWVmZmVjdC1wbGF5JylcbiAgICBcbiAgICB0aGlzLmJ1dHRvbl9mdWxsc2NyZWVuID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLWZ1bGxzY3JlZW4nKVxuXG4gICAgdGhpcy5idXR0b25fdG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PntcbiAgICAgIHRoaXMudG9nZ2xlU3RhdGUoKVxuICAgIH0pXG5cbiAgICB0aGlzLnRpbWVfc2Vla19iYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSk9PntcbiAgICAgIHRoaXMudGltZV9wb3NpdGlvbnMgPSB0aGlzLnRpbWVfc2Vla19iYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgIFxuICAgICAgdGhpcy51cGRhdGVUaW1lKGUpXG4gICAgfSlcblxuICAgIHRoaXMudGltZV9zZWVrX2Jhci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoKT0+e1xuICAgICAgaWYoIXRoaXMudGltZV9kcmFnKXtcbiAgICAgICAgdGhpcy50aW1lX3Bvc2l0aW9ucyA9IHRoaXMudGltZV9zZWVrX2Jhci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSAgICAgIFxuICAgICAgICB0aGlzLnRpbWVfZHJhZyA9IHRydWVcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCAoKT0+e1xuICAgICAgaWYodGhpcy50aW1lX2RyYWcpe1xuICAgICAgICB0aGlzLnRpbWVfZHJhZyA9IGZhbHNlXG4gICAgICB9XG5cbiAgICAgIGlmKHRoaXMudm9sdW1lX2RyYWcpe1xuICAgICAgICB0aGlzLnZvbHVtZV9kcmFnID0gZmFsc2VcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKT0+e1xuICAgICAgaWYodGhpcy50aW1lX2RyYWcpe1xuICAgICAgICB0aGlzLnVwZGF0ZVRpbWUoZSlcbiAgICAgIH1cbiAgICAgIGlmKHRoaXMudm9sdW1lX2RyYWcpe1xuICAgICAgICB0aGlzLnVwZGF0ZVZvbHVtZShlKSAgICAgICAgXG4gICAgICB9XG4gICAgfSlcblxuICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+e1xuICAgICAgdGhpcy50b2dnbGVNdXRlKClcbiAgICB9KVxuXG4gICAgdGhpcy52b2x1bWVfc2Vla19iYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT57XG4gICAgICB0aGlzLnZvbHVtZV9wb3NpdGlvbnMgPSB0aGlzLnZvbHVtZV9zZWVrX2Jhci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICAgICAgdGhpcy51cGRhdGVWb2x1bWUoZSlcbiAgICB9KVxuXG4gICAgdGhpcy52b2x1bWVfc2Vla19iYXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKCk9PntcbiAgICAgIGlmKCF0aGlzLnZvbHVtZV9kcmFnKXtcbiAgICAgICAgdGhpcy52b2x1bWVfcG9zaXRpb25zID0gdGhpcy52b2x1bWVfc2Vla19iYXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgICAgICBcbiAgICAgICAgdGhpcy52b2x1bWVfZHJhZyA9IHRydWVcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5idXR0b25fZnVsbHNjcmVlbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgICB0aGlzLnRvZ2dsZUZ1bGxzY3JlZW4oKVxuICAgIH0pXG5cbiAgICB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKCk9PntcbiAgICAgIHRoaXMudG9nZ2xlRnVsbHNjcmVlbigpICAgICAgXG4gICAgfSlcblxuICAgIHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xuICAgICAgdGhpcy50b2dnbGVTdGF0ZSgpXG4gICAgICBpZih0aGlzLnZpZGVvLnBhdXNlZCl7XG4gICAgICAgIHRoaXMuZWZmZWN0X3BsYXkuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcbiAgICAgICAgdGhpcy5lZmZlY3RfcGF1c2UuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICAgIH1cbiAgICAgIGVsc2V7XG4gICAgICAgIHRoaXMuZWZmZWN0X3BhdXNlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG4gICAgICAgIHRoaXMuZWZmZWN0X3BsYXkuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5wbGF5bGlzdCA9IHBsYXlsaXN0ICAgIFxuICAgIGlmKHRoaXMucGxheWxpc3Qpe1xuICAgICAgdGhpcy5jb250YWluZXJfcGxheWxpc3QgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLW5hdi13cmFwcGVyLWxpc3QnKVxuICAgICAgdGhpcy5wbGF5bGlzdF9pdGVtcyAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24tdmlkZW9zLW5hdi13cmFwcGVyLWxpc3QtaXRlbScpXG4gICAgICB0aGlzLnBsYXlsaXN0X25leHQgICAgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi12aWRlb3MtbmF2LWNvbnRyb2xzLS1uZXh0JylcbiAgICAgIHRoaXMucGxheWxpc3RfcHJldiAgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy1uYXYtY29udHJvbHMtLXByZXYnKVxuICAgICAgdGhpcy5wbGF5bGlzdF9pbmRleCAgICAgID0gMFxuICAgICAgdGhpcy5wbGF5bGlzdF9zZWxlY3RlZCAgID0gdGhpcy5wbGF5bGlzdF9pdGVtc1t0aGlzLnBsYXlsaXN0X2luZGV4XVxuICAgICAgdGhpcy5wbGF5bGlzdF9pdGVtX3dpZHRoID0gdGhpcy5wbGF5bGlzdF9pdGVtc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCArIDIwXG4gICAgICBcbiAgICAgIHRoaXMudmlkZW9faW5kZXggICA9IDBcbiAgICAgIHRoaXMudmlkZW9fcHJldiAgICA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyLWNvbnRyb2xzLS1za2lwLXByZXYnKVxuICAgICAgdGhpcy52aWRlb19uZXh0ICAgID0gdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXItY29udHJvbHMtLXNraXAtbmV4dCcpXG5cbiAgICAgIHRoaXMucGxheWxpc3RfbmV4dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgICAgIGlmKHRoaXMucGxheWxpc3RfaW5kZXggPCB0aGlzLnBsYXlsaXN0X2l0ZW1zLmxlbmd0aCAtIHRoaXMucGxheWxpc3Rfc2l6ZSl7XG4gICAgICAgICAgdGhpcy5wbGF5bGlzdF9pbmRleCsrXG4gICAgICAgICAgdGhpcy51cGRhdGVQbGF5bGlzdCgpXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHRoaXMucGxheWxpc3RfcHJldi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57XG4gICAgICAgIGlmKHRoaXMucGxheWxpc3RfaW5kZXggPiAwKXtcbiAgICAgICAgICB0aGlzLnBsYXlsaXN0X2luZGV4LS0gXG4gICAgICAgICAgdGhpcy51cGRhdGVQbGF5bGlzdCgpXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5wbGF5bGlzdF9pdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpc1xuICAgICAgICB0aGlzLnBsYXlsaXN0X2l0ZW1zW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICBpZih0aGlzICE9IHNlbGYucGxheWxpc3Rfc2VsZWN0ZWQpe1xuICAgICAgICAgICAgc2VsZi52aWRlb19pbmRleCA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoc2VsZi5wbGF5bGlzdF9pdGVtcywgdGhpcylcbiAgICAgICAgICAgIHNlbGYuc2VsZWN0VmlkZW8oKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgdGhpcy52aWRlb19wcmV2LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PntcbiAgICAgICAgaWYodGhpcy52aWRlb19pbmRleCA+IDApe1xuICAgICAgICAgIHRoaXMudmlkZW9faW5kZXgtLVxuICAgICAgICAgIHRoaXMuc2VsZWN0VmlkZW8oKVxuICAgICAgICB9XG4gICAgICAgIGVsc2V7XG4gICAgICAgICAgdGhpcy52aWRlb19wcmV2LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKVxuICAgICAgICAgIGNvbnNvbGUubG9nKCdub3AgcHJldicpXG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52aWRlb19uZXh0LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGUnKSAgXG4gICAgICB9KVxuXG4gICAgICB0aGlzLnZpZGVvX25leHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+e1xuICAgICAgICBpZih0aGlzLnZpZGVvX2luZGV4IDwgdGhpcy5wbGF5bGlzdF9pdGVtcy5sZW5ndGggLSAxKXtcbiAgICAgICAgICB0aGlzLnZpZGVvX2luZGV4KytcbiAgICAgICAgICB0aGlzLnNlbGVjdFZpZGVvKClcbiAgICAgICAgfVxuICAgICAgICBlbHNle1xuICAgICAgICAgIHRoaXMudmlkZW9fbmV4dC5jbGFzc0xpc3QuYWRkKCdoaWRlJylcbiAgICAgICAgICBjb25zb2xlLmxvZygnbm9wIG5leHQnKVxuICAgICAgICB9XG4gICAgICAgIHRoaXMudmlkZW9fcHJldi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJylcbiAgICAgIH0pXG5cbiAgICAgIHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignZW5kZWQnLCAoKT0+e1xuICAgICAgICBpZih0aGlzLnZpZGVvX2luZGV4IDwgdGhpcy5wbGF5bGlzdF9pdGVtcy5sZW5ndGggLSAxKXtcbiAgICAgICAgICB0aGlzLnZpZGVvX2luZGV4KytcbiAgICAgICAgICB0aGlzLnNlbGVjdFZpZGVvKClcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgdGhpcy5pbml0UGxheWxpc3QoKVxuICAgIH1cblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCAoKT0+e1xuICAgICAgdGhpcy5wbGF5bGlzdF9pdGVtX3dpZHRoID0gdGhpcy5wbGF5bGlzdF9pdGVtc1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCArIDIwICAgICAgXG4gICAgICBpZih0aGlzLnBsYXlsaXN0KXtcbiAgICAgICAgY29uc29sZS5sb2coJ3Jlc2l6ZScpXG4gICAgICAgIHRoaXMuaW5pdFBsYXlsaXN0KClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5pbml0KClcbiAgICAgIFxuICB9XG5cbiAgLy8gaW5pdCBuZXcgdmlkZW9cbiAgaW5pdCgpe1xuICAgIHRoaXMuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXlpbmcnKVxuICAgIHRoaXMuZWZmZWN0X3BhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgdGhpcy5lZmZlY3RfcGxheS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICAgIHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkZGF0YScsICgpID0+e1xuICAgICAgdGhpcy52aWRlby5jdXJyZW50VGltZSA9IC40NVxuICAgICAgdGhpcy50aW1lX2R1cmF0aW9uLnRleHRDb250ZW50ID0gdGhpcy5mb3JtYXRUaW1lKHRoaXMudmlkZW8uZHVyYXRpb24pICAgXG4gICAgICB0aGlzLnRpbWVfY3VycmVudC50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmN1cnJlbnRUaW1lKSAgICAgICBcbiAgICAgIFxuICAgICAgdGhpcy50aW1lX3NlZWtfYmFyX2ZpbGwuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlWCgwKScgICAgXG4gICAgfSkgICAgXG4gIH1cblxuICBpbml0UGxheWxpc3QoKXtcbiAgICBsZXQgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aFxuICAgIGlmKHdpZHRoIDwgNDI1KXtcbiAgICAgIHRoaXMucGxheWxpc3Rfc2l6ZSA9IDFcbiAgICB9XG4gICAgZWxzZSBpZih3aWR0aCA8IDY1MCl7XG4gICAgICB0aGlzLnBsYXlsaXN0X3NpemUgPSAyXG4gICAgfVxuICAgIGVsc2UgaWYod2lkdGggPCA5MDApe1xuICAgICAgdGhpcy5wbGF5bGlzdF9zaXplID0gM1xuICAgIH1cbiAgICBlbHNlIGlmKHdpZHRoIDwgMTMwMCl7XG4gICAgICB0aGlzLnBsYXlsaXN0X3NpemUgPSA1XG4gICAgfVxuICAgIGVsc2UgaWYod2lkdGggPCAyNTAwKXtcbiAgICAgIHRoaXMucGxheWxpc3Rfc2l6ZSA9IDZcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRoaXMucGxheWxpc3Rfc2l6ZSA9IDkgICAgICBcbiAgICB9XG5cbiAgICB0aGlzLnBsYXlsaXN0X2luZGV4ID0gMCAgICBcbiAgICB0aGlzLnVwZGF0ZVBsYXlsaXN0KClcbiAgfVxuXG5cbiAgLy91cGRhdGUgZnVuY1xuICB0b2dnbGVTdGF0ZSgpe1xuICAgIGlmKHRoaXMudmlkZW8ucGF1c2VkKXtcbiAgICAgIHRoaXMudmlkZW8ucGxheSgpXG4gICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdwbGF5aW5nJylcbiAgICAgIHRoaXMucmVuZGVyKClcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRoaXMudmlkZW8ucGF1c2UoKVxuICAgICAgdGhpcy5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgncGxheWluZycpXG4gICAgfVxuICAgIHRoaXMuZWZmZWN0X3BhdXNlLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgdGhpcy5lZmZlY3RfcGxheS5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKVxuICB9XG5cbiAgdXBkYXRlVGltZShlKXtcbiAgICBsZXQgcmF0aW8gPSAoZS5wYWdlWCAtIHRoaXMudGltZV9wb3NpdGlvbnMubGVmdCkgLyB0aGlzLnRpbWVfcG9zaXRpb25zLndpZHRoXG4gICAgaWYocmF0aW8gPj0gMCAmJiByYXRpbyA8IDEpeyAgICAgIFxuICAgICAgdGhpcy50aW1lX3NlZWtfYmFyX2ZpbGwuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlWCgnKyByYXRpbyArJyknXG4gICAgICB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lID0gcmF0aW8gKiB0aGlzLnZpZGVvLmR1cmF0aW9uXG4gICAgICB0aGlzLnRpbWVfY3VycmVudC50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmN1cnJlbnRUaW1lKVxuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZVZvbHVtZShlKXtcbiAgICBsZXQgcmF0aW8gPSAoZS5wYWdlWCAtIHRoaXMudm9sdW1lX3Bvc2l0aW9ucy5sZWZ0KSAvIHRoaXMudm9sdW1lX3Bvc2l0aW9ucy53aWR0aFxuICAgICAgaWYocmF0aW8gPj0gMCAmJiByYXRpbyA8IDEpe1xuICAgICAgdGhpcy52aWRlby52b2x1bWUgPSByYXRpb1xuICAgICAgdGhpcy52b2x1bWVfc2Vla19iYXJfZmlsbC5zdHlsZS50cmFuc2Zvcm0gPSAnc2NhbGVYKCcrIHJhdGlvICsnKScgICAgXG4gICAgICBpZih0aGlzLnZpZGVvLm11dGVkKXtcbiAgICAgICAgdGhpcy50b2dnbGVNdXRlKClcbiAgICAgIH1cblxuICAgICAgaWYocmF0aW8gPj0gLjUpe1xuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LmFkZCgndm9sdW1lLTInKVxuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTEnKVxuICAgICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgndm9sdW1lLTAnKVxuICAgICAgfVxuICAgICAgZWxzZSBpZihyYXRpbyA8IC41ICYmIHJhdGlvID49IC4yNSl7XG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMicpXG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QuYWRkKCd2b2x1bWUtMScpXG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMCcpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKHJhdGlvIDwgLjI1KXtcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ3ZvbHVtZS0yJylcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5yZW1vdmUoJ3ZvbHVtZS0xJylcbiAgICAgICAgdGhpcy5idXR0b25fdm9sdW1lLmNsYXNzTGlzdC5hZGQoJ3ZvbHVtZS0wJylcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYocmF0aW8gPD0gMCl7XG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMicpXG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMScpXG4gICAgICAgIHRoaXMuYnV0dG9uX3ZvbHVtZS5jbGFzc0xpc3QucmVtb3ZlKCd2b2x1bWUtMCcpXG4gICAgICAgIHRoaXMudG9nZ2xlTXV0ZSgpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlTXV0ZSgpe1xuICAgIGlmKHRoaXMudmlkZW8ubXV0ZWQpe1xuICAgICAgdGhpcy52aWRlby5tdXRlZCA9IGZhbHNlXG4gICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LnJlbW92ZSgnbXV0ZScpXG4gICAgICB0aGlzLnZvbHVtZV9zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoJysgdGhpcy52aWRlby52b2x1bWUgKycpJyAgICAgICAgICBcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRoaXMudmlkZW8ubXV0ZWQgPSB0cnVlXG4gICAgICB0aGlzLmJ1dHRvbl92b2x1bWUuY2xhc3NMaXN0LmFkZCgnbXV0ZScpXG4gICAgICB0aGlzLnZvbHVtZV9zZWVrX2Jhcl9maWxsLnN0eWxlLnRyYW5zZm9ybSA9ICdzY2FsZVgoMCknICAgIFxuICAgIH1cbiAgfVxuXG4gIHRvZ2dsZUZ1bGxzY3JlZW4oKXtcbiAgICBpZihkb2N1bWVudC5mdWxsc2NyZWVuRWxlbWVudCA9PSBudWxsICYmwqBkb2N1bWVudC5tb3pGdWxsc2NyZWVuRWxlbWVudCA9PSBudWxsICYmwqBkb2N1bWVudC53ZWJraXRGdWxsc2NyZWVuRWxlbWVudCA9PSBudWxsICYmIGRvY3VtZW50Lm1zRnVsbHNjcmVlbkVsZW1lbnQ9PSBudWxsICl7XG4gICAgICBpZih0aGlzLmNvbnRhaW5lci5yZXF1ZXN0RnVsbHNjcmVlbil7XG4gICAgICAgIHRoaXMuY29udGFpbmVyLnJlcXVlc3RGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYodGhpcy5jb250YWluZXIubW96UmVxdWVzdEZ1bGxTY3JlZW4pe1xuICAgICAgICB0aGlzLmNvbnRhaW5lci5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKHRoaXMuY29udGFpbmVyLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKXtcbiAgICAgICAgdGhpcy5jb250YWluZXIud2Via2l0UmVxdWVzdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZih0aGlzLmNvbnRhaW5lci5tc1JlcXVlc3RGdWxsc2NyZWVuKXtcbiAgICAgICAgdGhpcy5jb250YWluZXIubXNSZXF1ZXN0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICBpZihkb2N1bWVudC5leGl0RnVsbHNjcmVlbil7XG4gICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKClcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYoZG9jdW1lbnQubW96RXhpdEZ1bGxTY3JlZW4pe1xuICAgICAgICBkb2N1bWVudC5tb3pFeGl0RnVsbFNjcmVlbigpXG4gICAgICB9XG4gICAgICBlbHNlIGlmKGRvY3VtZW50LndlYmtpdEV4aXRGdWxsc2NyZWVuKXtcbiAgICAgICAgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKVxuICAgICAgfVxuICAgICAgZWxzZSBpZihkb2N1bWVudC5tc0V4aXRGdWxsc2NyZWVuKXtcbiAgICAgICAgZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbigpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy9wbGF5bGlzdFxuICB1cGRhdGVQbGF5bGlzdCgpe1xuICAgIHRoaXMuY29udGFpbmVyX3BsYXlsaXN0LnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAodGhpcy5wbGF5bGlzdF9pbmRleCAqIHRoaXMucGxheWxpc3RfaXRlbV93aWR0aCkgKydweCknXG4gICAgXG4gICAgaWYodGhpcy5wbGF5bGlzdF9pbmRleCA9PSAwKXtcbiAgICAgIHRoaXMucGxheWxpc3RfcHJldi5jbGFzc0xpc3QuYWRkKCdoaWRlJykgICAgICAgICAgXG4gICAgfVxuICAgIGVsc2V7XG4gICAgICB0aGlzLnBsYXlsaXN0X3ByZXYuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpICAgICAgICAgIFxuICAgIH1cblxuICAgIGlmKHRoaXMucGxheWxpc3RfaW5kZXggID49ICh0aGlzLnBsYXlsaXN0X2l0ZW1zLmxlbmd0aCAtIHRoaXMucGxheWxpc3Rfc2l6ZSkpe1xuICAgICAgdGhpcy5wbGF5bGlzdF9uZXh0LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKSAgICAgICBcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRoaXMucGxheWxpc3RfbmV4dC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJykgICAgXG4gICAgfVxuICB9XG5cbiAgc2VsZWN0VmlkZW8oKXtcbiAgICB0aGlzLnBsYXlsaXN0X3NlbGVjdGVkLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgdGhpcy5wbGF5bGlzdF9zZWxlY3RlZCA9IHRoaXMucGxheWxpc3RfaXRlbXNbdGhpcy52aWRlb19pbmRleF1cbiAgICB0aGlzLnBsYXlsaXN0X3NlbGVjdGVkLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpXG5cbiAgICB0aGlzLnZpZGVvLnNyYyA9IHRoaXMucGxheWxpc3Rfc2VsZWN0ZWQuZGF0YXNldC50YXJnZXRcbiAgICB0aGlzLmluaXQoKVxuXG4gICAgaWYodGhpcy52aWRlb19pbmRleCA+IHRoaXMucGxheWxpc3RfaW5kZXggKyB0aGlzLnBsYXlsaXN0X3NpemUgLSAxKXtcbiAgICAgIHRoaXMucGxheWxpc3RfaW5kZXgrK1xuICAgICAgdGhpcy51cGRhdGVQbGF5bGlzdCgpXG4gICAgfVxuICAgIGVsc2UgaWYodGhpcy52aWRlb19pbmRleCA8IHRoaXMucGxheWxpc3RfaW5kZXgpe1xuICAgICAgdGhpcy5wbGF5bGlzdF9pbmRleC0tXG4gICAgICB0aGlzLnVwZGF0ZVBsYXlsaXN0KCkgICAgICBcbiAgICB9XG5cbiAgICBpZih0aGlzLnZpZGVvX2luZGV4ID09IDApe1xuICAgICAgdGhpcy52aWRlb19wcmV2LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKSAgICAgICAgICBcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRoaXMudmlkZW9fcHJldi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJykgICAgICAgICAgXG4gICAgfVxuXG4gICAgaWYodGhpcy52aWRlb19pbmRleCAgPj0gKHRoaXMucGxheWxpc3RfaXRlbXMubGVuZ3RoIC0gMSkpe1xuICAgICAgdGhpcy52aWRlb19uZXh0LmNsYXNzTGlzdC5hZGQoJ2hpZGUnKSAgICAgICBcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHRoaXMudmlkZW9fbmV4dC5jbGFzc0xpc3QucmVtb3ZlKCdoaWRlJykgICAgXG4gICAgfVxuICB9XG4gIFxuXG5cbiAgLy9yZW5kZXIgZnVuY1xuICByZW5kZXIoKXtcbiAgICBpZighdGhpcy52aWRlby5wYXVzZWQpe1xuICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLnJlbmRlci5iaW5kKHRoaXMpKVxuICAgIH1cblxuICAgIGxldCByYXRpbyA9IHRoaXMudmlkZW8uY3VycmVudFRpbWUgLyB0aGlzLnZpZGVvLmR1cmF0aW9uXG4gICAgdGhpcy50aW1lX3NlZWtfYmFyX2ZpbGwuc3R5bGUudHJhbnNmb3JtID0gJ3NjYWxlWCgnKyByYXRpbyArJyknXG5cbiAgICB0aGlzLnRpbWVfY3VycmVudC50ZXh0Q29udGVudCA9IHRoaXMuZm9ybWF0VGltZSh0aGlzLnZpZGVvLmN1cnJlbnRUaW1lKVxuICAgIFxuICAgIGlmKHRoaXMudmlkZW8uY3VycmVudFRpbWUgPT0gdGhpcy52aWRlby5kdXJhdGlvbil7XG4gICAgICB0aGlzLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdwbGF5aW5nJykgICAgICBcbiAgICB9XG4gIH1cblxuXG4gIC8vIHVzZWZ1bGwgZnVuY1xuICBmb3JtYXRUaW1lKHRpbWUpe1xuICAgIHRpbWUgID0gTWF0aC5yb3VuZCh0aW1lKVxuICAgIGxldCBob3VycyAgID0gTWF0aC5mbG9vcih0aW1lIC8gMzYwMCk7XG4gICAgbGV0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKCh0aW1lIC0gKGhvdXJzICogMzYwMCkpIC8gNjApO1xuICAgIGxldCBzZWNvbmRzID0gdGltZSAtIChob3VycyAqIDM2MDApIC0gKG1pbnV0ZXMgKiA2MCk7XG5cbiAgICBob3VycyAgID0gaG91cnMgICA8IDEwID8gXCIwXCIraG91cnMgOiBob3Vyc1xuICAgIG1pbnV0ZXMgPSBtaW51dGVzIDwgMTAgPyBcIjBcIittaW51dGVzIDogbWludXRlc1xuICAgIHNlY29uZHMgPSBzZWNvbmRzIDwgMTAgPyBcIjBcIitzZWNvbmRzIDogc2Vjb25kc1xuXG4gICAgaWYoaG91cnMgIT0gMCl7XG4gICAgICByZXR1cm4gaG91cnMrJzonK21pbnV0ZXMrJzonK3NlY29uZHNcbiAgICB9XG4gICAgZWxzZXtcbiAgICAgIHJldHVybiBtaW51dGVzKyc6JytzZWNvbmRzXG4gICAgfVxuICB9XG59IiwiLy8gSEVBREVSIEJVUkdFUlxuY29uc3QgYnVyZ2VyX2J1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXItYnVyZ2VyJylcbmNvbnN0IGJ1cmdlcl9uYXYgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyLW5hdicpXG5cbmJ1cmdlcl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbigpe1xuICBidXJnZXJfYnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2hlYWRlci1idXJnZXItYWN0aXZlJylcbiAgYnVyZ2VyX25hdi5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItbmF2LWV4cGFuZCcpXG59KVxuXG5jb25zdCBoZWFkZXIgICAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyJylcbmxldCBoZWFkZXJfaGlkZSA9IGZhbHNlXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V3aGVlbCcsIGZ1bmN0aW9uKGUpe1xuICBpZighaGVhZGVyX2hpZGUgJiYgZS5kZWx0YVkgPCAwKXtcbiAgICBoZWFkZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZScpXG4gICAgaGVhZGVyX2hpZGUgPSB0cnVlXG4gIH1cbiAgZWxzZSBpZihoZWFkZXJfaGlkZSAmJiBlLmRlbHRhWSA+IDAgJiYgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPiA4MCl7XG4gICAgaGVhZGVyLmNsYXNzTGlzdC5hZGQoJ2hpZGUnKSAgICBcbiAgICBoZWFkZXJfaGlkZSA9IGZhbHNlXG4gIH1cbn0pXG5cblxuLy8gRVhISUJJVElPTlMgU0xJREVSXG5pZihkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2VjdGlvbi1leGhpYml0aW9ucycpICE9IHVuZGVmaW5lZCl7XG4gIGNvbnN0IGV4aGliaXRpb25zX2J1dHRvbnNfaXRlbSAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlY3Rpb24tZXhoaWJpdGlvbnMtY29udGFpbmVyLXNsaWRlci1uYXYtbGlzdC0taXRlbScpXG4gIGNvbnN0IGV4aGliaXRpb25zX2J1dHRvbnNfY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tZXhoaWJpdGlvbnMtY29udGFpbmVyLXNsaWRlci1uYXYtbGlzdCcpXG4gIGNvbnN0IGV4aGliaXRpb25zX2xpc3RfaW1nICAgICAgICAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tZXhoaWJpdGlvbnMtY29udGFpbmVyLXNsaWRlci13cmFwcGVyLWxpc3QnKVxuICBjb25zdCBleGhpYml0aW9uc19saXN0X2NvbnRlbnQgICAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLWV4aGliaXRpb25zLWNvbnRhaW5lci1jb250ZW50LXdyYXBwZXItbGlzdCcpXG4gIGxldCBleGhpYml0aW9uc19sYXN0X2luZGV4ICAgICAgICAgID0gMFxuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtLmxlbmd0aDsgaSsrKSB7XG4gICAgZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtW2ldLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKXtcbiAgICAgIGxldCBpbmRleCA9IEFycmF5LnByb3RvdHlwZS5pbmRleE9mLmNhbGwoZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtLCB0aGlzKVxuXG4gICAgICBpZihleGhpYml0aW9uc19idXR0b25zX2l0ZW1bZXhoaWJpdGlvbnNfbGFzdF9pbmRleF0gIT0gdW5kZWZpbmVkKXtcbiAgICAgICAgZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtW2V4aGliaXRpb25zX2xhc3RfaW5kZXhdLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXG4gICAgICB9XG4gICAgICBleGhpYml0aW9uc19sYXN0X2luZGV4ID0gaW5kZXhcblxuICAgICAgZXhoaWJpdGlvbnNfYnV0dG9uc19pdGVtW2luZGV4XS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxuXG4gICAgICBpZih3aW5kb3cuaW5uZXJXaWR0aCA+PSA5MDApe1xuICAgICAgICBleGhpYml0aW9uc19saXN0X2ltZy5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKGluZGV4ICogMTAwKSArJyUpJ1xuICAgICAgICBleGhpYml0aW9uc19saXN0X2NvbnRlbnQuc3R5bGUudHJhbnNmb3JtID0gJ3RyYW5zbGF0ZVgoLScrIChpbmRleCAqIDEwMCkgKyclKSdcbiAgICAgIH1cbiAgICAgIGVsc2V7XG4gICAgICAgIGV4aGliaXRpb25zX2xpc3RfaW1nLnN0eWxlLnRyYW5zZm9ybSA9ICd0cmFuc2xhdGVYKC0nKyAoaW5kZXggKiAxMDApICsnJSknXG4gICAgICAgIGV4aGliaXRpb25zX2xpc3RfY29udGVudC5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKGluZGV4ICogMTAwKSArJyUpJ1xuICAgICAgICBleGhpYml0aW9uc19idXR0b25zX2NvbnRhaW5lci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWCgtJysgKCgoaW5kZXgtMSkvMykgKiAxMDApICsnJSknXG4gICAgICB9XG5cbiAgICB9KVxuICB9XG59XG5cbi8vIEhPTUUgUExBWUVSKVxuaWYoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNlY3Rpb24tdmlkZW9zLXdyYXBwZXInKSAhPSB1bmRlZmluZWQpe1xuICBjb25zdCBwbGF5ZXIgPSBuZXcgUGxheWVyKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zZWN0aW9uLXZpZGVvcy13cmFwcGVyJyksIHRydWUpXG59Il19
